!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e){},function(t,e,r){},function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.r(e),r.d(e,"spreadsheet",(function(){return oh}));var c=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";a(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=r):this.el=e,this.data={}}return e=t,(r=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var r=o(t.split(".")),n=r[0],i=r.slice(1),a=n;return"mousewheel"===a&&/Firefox/i.test(window.navigator.userAgent)&&(a="DOMMouseScroll"),this.el.addEventListener(a,(function(t){e(t);for(var r=0;r<i.length;r+=1){var n=i[r];if("left"===n&&0!==t.button)return;if("right"===n&&2!==t.button)return;"stop"===n&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(r){e.css(r,"".concat(t[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(r.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var r=e;return"string"==typeof e?r=document.createTextNode(e):e instanceof t&&(r=e.el),r.contains(this.el)?console.warn(r,"contains",this.el):this.el.appendChild(r),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var r=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){r.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var r=this;return"string"!=typeof t?(Object.keys(t).forEach((function(n){r.el.style.setProperty(n,t[n]+(e||""))})),this):void 0!==e?(this.el.style.setProperty(t,e),this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}(),f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new c(t,e)};r(0);function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var y=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function p(t){for(var e="",r=t;r>=y.length;)r/=y.length,r-=1,e+=y[parseInt(r,10)%y.length];return e+=y[t%y.length]}function v(t){for(var e=0,r=0;r<t.length-1;r+=1){var n=t.charCodeAt(r)-65,o=t.length-1-r;e+=Math.pow(y.length,o)+y.length*n}return e+=t.charCodeAt(t.length-1)-65}function d(t){for(var e="",r="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?r+=t.charAt(n):e+=t.charAt(n);return[v(e),parseInt(r,10)-1]}function b(t,e){return"".concat(p(t)).concat(e+1)}function m(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===r)return t;var o=d(t),i=s(o,2),a=i[0],l=i[1];return n(a,l)?b(a+e,l+r):t}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return S(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k(n.key),n)}}function k(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==g(e)?e:e+""}var P=function(){function t(e,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;O(this,t),this.sri=e,this.sci=r,this.eri=n,this.eci=o,this.w=i,this.h=a}return e=t,n=[{key:"valueOf",value:function(e){var r=e.split(":"),n=w(d(r[0]),2),o=n[0],i=n[1],a=i,l=o;if(r.length>1){var u=w(d(r[1]),2);l=u[0],a=u[1]}return new t(i,o,a,l)}}],(r=[{key:"set",value:function(t,e,r,n){this.sri=t,this.sci=e,this.eri=r,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];if(1===n.length){var i=d(n[0]),a=w(i,2);e=a[0],t=a[1]}else 2===n.length&&(t=n[0],e=n[1]);var l=this.sri,u=this.sci,c=this.eri,f=this.eci;return l<=t&&t<=c&&u<=e&&e<=f}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=this.sri,n=this.sci,o=this.eri,i=this.eci,a=r;a<=o;a+=1)if(e(a))for(var l=n;l<=i;l+=1)t(a,l)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var r=this.sri,n=this.sci,o=this.eri,i=this.eci;return new t(e.sri<r?e.sri:r,e.sci<n?e.sci:n,e.eri>o?e.eri:o,e.eci>i?e.eci:i)}},{key:"difference",value:function(e){var r=[],n=function(e,n,o,i){r.push(new t(e,n,o,i))},o=this.sri,i=this.sci,a=this.eri,l=this.eci,u=e.sri-o,c=e.sci-i,f=a-e.eri,s=l-e.eci;return u>0?(n(o,i,e.sri-1,l),f>0?(n(e.eri+1,i,a,l),c>0&&n(e.sri,i,e.eri,e.sci-1),s>0&&n(e.sri,e.eci+1,e.eri,l)):(c>0&&n(e.sri,i,a,e.sci-1),s>0&&n(e.sri,e.eci+1,a,l))):f>0&&(n(e.eri+1,i,a,l),c>0&&n(o,i,e.eri,e.sci-1),s>0&&n(o,e.eci+1,e.eri,l)),c>0?(n(o,i,a,e.sci-1),s>0?(n(o,e.eri+1,a,l),u>0&&n(o,e.sci,e.sri-1,e.eci),f>0&&n(e.sri+1,e.sci,a,e.eci)):(u>0&&n(o,e.sci,e.sri-1,l),f>0&&n(e.sri+1,e.sci,a,l))):s>0&&(n(a,e.eci+1,a,l),u>0&&n(o,i,e.sri-1,e.eci),f>0&&n(e.eri+1,i,a,e.eci)),r}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,r=this.eri,n=this.eci,o=b(e,t);return this.multiple()&&(o="".concat(o,":").concat(b(n,r))),o}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&j(e.prototype,r),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T(n.key),n)}}function T(t){var e=function(t,e){if("object"!=E(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==E(e)?e:e+""}var C=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new P(0,0,0,0),this.ri=0,this.ci=0},(e=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&x(t.prototype,e),r&&x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,I(n.key),n)}}function R(t,e,r){return e&&A(t.prototype,e),r&&A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function I(t){var e=function(t,e){if("object"!=_(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_(e)?e:e+""}var D=R((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0}));function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,M(n.key),n)}}function M(t){var e=function(t,e){if("object"!=N(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==N(e)?e:e+""}var H=function(){return t=function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];z(this,t),this.undoItems=[],this.redoItems=[],this.enabled=e},(e=[{key:"add",value:function(t){this.enabled&&(this.undoItems.push(JSON.stringify(t)),this.redoItems=[])}},{key:"canUndo",value:function(){if(this.enabled)return this.undoItems.length>0}},{key:"canRedo",value:function(){if(this.enabled)return this.redoItems.length>0}},{key:"undo",value:function(t,e){if(this.enabled){var r=this.undoItems,n=this.redoItems;this.canUndo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}}},{key:"redo",value:function(t,e){if(this.enabled){var r=this.undoItems,n=this.redoItems;this.canRedo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}}}])&&B(t.prototype,e),r&&B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,V(n.key),n)}}function V(t){var e=function(t,e){if("object"!=F(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==F(e)?e:e+""}var U=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"},(e=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&W(t.prototype,e),r&&W(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X(n.key),n)}}function J(t,e,r){return e&&L(t.prototype,e),r&&L(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function X(t){var e=function(t,e){if("object"!=$(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$(e)?e:e+""}var Y=function(){return J((function t(e,r,n){q(this,t),this.ci=e,this.operator=r,this.value=n}),[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,r=this.value;return"all"===e||"in"===e&&r.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}])}(),Z=function(){return J((function t(e,r){q(this,t),this.ci=e,this.order=r}),[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}])}(),K=function(){return J((function t(){q(this,t),this.ref=null,this.filters=[],this.sort=null}),[{key:"setData",value:function(t){var e=t.ref,r=t.filters,n=t.sort;null!=e&&(this.ref=e,this.filters=r.map((function(t){return new Y(t.ci,t.operator,t.value)})),n&&(this.sort=new Z(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,r=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:r}}return{}}},{key:"addFilter",value:function(t,e,r){var n=this.getFilter(t);null==n?this.filters.push(new Y(t,e,r)):n.set(e,r)}},{key:"setSort",value:function(t,e){this.sort=e?new Z(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,r=0;r<e.length;r+=1)if(e[r].ci===t)return e[r];return null}},{key:"filteredRows",value:function(t){var e=new Set,r=new Set;if(this.active())for(var n=this.range(),o=n.sri,i=n.eri,a=this.filters,l=o+1;l<=i;l+=1)for(var u=0;u<a.length;u+=1){var c=a[u],f=t(l,c.ci),s=f?f.text:"";if(!c.includes(s)){e.add(l);break}r.add(l)}return{rset:e,fset:r}}},{key:"items",value:function(t,e){var r={};if(this.active())for(var n=this.range(),o=n.sri,i=n.eri,a=o+1;a<=i;a+=1){var l=e(a,t);if(null===l||/^\s*$/.test(l.text))r[""]=(r[""]||0)+1;else{var u=l.text,c=(r[u]||0)+1;r[u]=c}}return r}},{key:"range",value:function(){return P.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}])}();function G(t){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,et(n.key),n)}}function et(t){var e=function(t,e){if("object"!=G(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==G(e)?e:e+""}var rt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Q(this,t),this._=e}return e=t,(r=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(t,e))return n}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,r,n){this._.forEach((function(o){var i=o.sri,a=o.sci,l=o.eri,u=o.eci,c=o;"row"===t?i>=e?(c.sri+=r,c.eri+=r):i<e&&e<=l&&(c.eri+=r,n(i,a,r,0)):"column"===t&&(a>=e?(c.sci+=r,c.eci+=r):a<e&&e<=u&&(c.eci+=r,n(i,a,0,r)))}))}},{key:"move",value:function(t,e,r){this._.forEach((function(n){var o=n;o.within(t)&&(o.eri+=e,o.sri+=e,o.sci+=r,o.eci+=r)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return P.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&tt(e.prototype,r),n&&tt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();var nt=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return r.forEach((function(e){Object.keys(e).forEach((function(r){var n=e[r];"string"==typeof n||"number"==typeof n||"boolean"==typeof n?t[r]=n:"function"!=typeof n&&!Array.isArray(n)&&n instanceof Object?(t[r]=t[r]||{},nt(t[r],n)):t[r]=n}))})),t};function ot(t){for(var e="".concat(t),r=0,n=!1,o=0;o<e.length;o+=1)!0===n&&(r+=1),"."===e.charAt(o)&&(n=!0);return r}function it(t){var e={},r=(t=t.toString()).match(/(\$*)\s*(\d*(\.|,)*\d*)\s*(hrs*|hr*|%*)/m);return""===r[0]?e.number=Number.isNaN(parseFloat(t))?0:parseFloat(t):e.number=r[2].replace(",",""),e.prefix=r[1],e.sufix=r[4],e}function at(t,e,r){var n,o;if(Number.isNaN(e)||Number.isNaN(r))return e+t+r;var i=it(e);e=i.number,i.prefix,i.sufix,r=(i=it(r)).number,n=i.prefix,o=i.sufix;var a=ot(e),l=ot(r),u=Number(e),c=Number(r),f=0;if("-"===t)f=u-c;else if("+"===t)f=u+c;else if("*"===t)f=u*c;else if("/"===t)return ot(f=u/c)>5?f.toFixed(2):f;return n+f.toFixed(Math.max(a,l))+o}var lt={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return nt.apply(void 0,[{}].concat(e))},equals:function t(e,r){var n=Object.keys(e);if(n.length!==Object.keys(r).length)return!1;for(var o=0;o<n.length;o+=1){var i=n[o],a=e[i],l=r[i];if(void 0===l)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==l)return!1}else if(Array.isArray(a)){if(a.length!==l.length)return!1;for(var u=0;u<a.length;u+=1)if(!t(a[u],l[u]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,l))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r+=1)if(t[r]!==e[r])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=0,n=0;return Object.keys(t).forEach((function(o){r+=e(t[o],o),n+=1})),[r,n]},rangeEach:function(t,e,r){for(var n=t;n<e;n+=1)r(n)},rangeSum:function(t,e,r){for(var n=0,o=t;o<e;o+=1)n+=r(o);return n},rangeReduceIf:function(t,e,r,n,o,i){for(var a=r,l=n,u=t;u<e&&!(a>o);u+=1)a+=l=i(u);return[u,a-l,l]},deleteProperty:function(t,e){var r=t["".concat(e)];return delete t["".concat(e)],r},numberCalc:at};function ut(t){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ct(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ft(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ft(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function st(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ht(n.key),n)}}function ht(t){var e=function(t,e){if("object"!=ut(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ut(e)?e:e+""}var yt=function(){return t=function t(e,r){var n=e.len,o=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=o,this.sheet=r},(e=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,r){var n=this;return lt.rangeSum(t,e,(function(t){return r&&r.has(t)?0:n.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var r=this.get(t);return void 0!==r&&void 0!==r.cells&&void 0!==r.cells[e]?r.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var r=this.getCell(t,e);return r&&r.merge?r.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var r=this.getOrNew(t);return r.cells[e]=r.cells[e]||{},r.cells[e]}},{key:"setCell",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",o=this.getOrNew(t);"all"===n?o.cells[e]=r:"text"===n?(o.cells[e]=o.cells[e]||{},o.cells[e].text=r.text):"format"===n&&(o.cells[e]=o.cells[e]||{},o.cells[e].style=r.style,r.merge&&(o.cells[e].merge=r.merge))}},{key:"setCellText",value:function(t,e,r){var n=this.getCellOrNew(t,e);!1!==n.editable&&(n.text=r)}},{key:"copyPaste",value:function(t,e,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=t.sri,l=t.sci,u=t.eri,c=t.eci,f=e.sri,s=e.sci,h=e.eri,y=e.eci,p=t.size(),v=ct(p,2),d=v[0],b=v[1],g=e.size(),w=ct(g,2),S=w[0],O=w[1],j=!0,k=0;(h<a||y<l)&&(j=!1,k=h<a?S:O);for(var P=a;P<=u;P+=1)if(this._[P])for(var E=l;E<=c;E+=1)if(this._[P].cells&&this._[P].cells[E])for(var x=f;x<=h;x+=d)for(var T=function(){var t=x+(P-a),e=C+(E-l),p=lt.cloneDeep(n._[P].cells[E]);if(o&&p&&p.text&&p.text.length>0){var v=p.text,g=C-s+(x-f)+2;if(j||(g-=k+1),"="===v[0])p.text=v.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){var e=0,r=0;return a===f?e=g-1:r=g-1,/^\d+$/.test(t)?t:m(t,e,r)}));else if(d<=1&&b>1&&(f>u||h<a)||b<=1&&d>1&&(s>c||y<l)||d<=1&&b<=1){var w=/[\\.\d]+$/.exec(v);if(null!==w){var S=Number(w[0])+g-1;p.text=v.substring(0,w.index)+S}}}n.setCell(t,e,p,r),i(t,e,p)},C=s;C<=y;C+=b)T()}},{key:"cutPaste",value:function(t,e){var r=this,n={};this.each((function(o){r.eachCells(o,(function(i){var a=parseInt(o,10),l=parseInt(i,10);t.includes(o,i)&&(a=e.sri+(a-t.sri),l=e.sci+(l-t.sci)),n[a]=n[a]||{cells:{}},n[a].cells[l]=r._[o].cells[i]}))})),this._=n}},{key:"paste",value:function(t,e){var r=this;if(!(t.length<=0)){var n=e.sri,o=e.sci;t.forEach((function(t,e){var i=n+e;t.forEach((function(t,e){var n=o+e;r.setCellText(i,n,t)}))}))}}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};this.each((function(o,i){var a=parseInt(o,10);a>=t&&(a+=r,e.eachCells(o,(function(e,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return m(e,0,r,(function(e,r){return r>=t}))})))}))),n[a]=i})),this._=n,this.len+=r}},{key:"delete",value:function(t,e){var r=this,n=e-t+1,o={};this.each((function(i,a){var l=parseInt(i,10);l<t?o[l]=a:i>e&&(o[l-n]=a,r.eachCells(i,(function(t,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return m(t,0,-n,(function(t,r){return r>e}))})))})))})),this._=o,this.len-=n}},{key:"insertColumn",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(n,o){var i={};e.eachCells(n,(function(e,n){var o=parseInt(e,10);o>=t&&(o+=r,n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return m(e,r,0,(function(e){return e>=t}))})))),i[o]=n})),o.cells=i}))}},{key:"deleteColumn",value:function(t,e){var r=this,n=e-t+1;this.each((function(o,i){var a={};r.eachCells(o,(function(r,o){var i=parseInt(r,10);i<t?a[i]=o:i>e&&(a[i-n]=o,o.text&&"="===o.text[0]&&(o.text=o.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return m(t,-n,0,(function(t){return t>e}))}))))})),i.cells=a}))}},{key:"deleteCells",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,n){e.deleteCell(t,n,r),e.sheet.trigger("delete-cell",t,n)}))}},{key:"deleteCell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(t);if(null!==n){var o=this.getCell(t,e);null!==o&&("all"===r?delete n.cells[e]:"text"===r?(o.text&&delete o.text,o.value&&delete o.value):"format"===r?(void 0!==o.style&&delete o.style,o.merge&&delete o.merge):"merge"===r&&o.merge&&delete o.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],r=this._[e];if(r){var n=r.cells,o=Object.keys(n),i=o[o.length-1];return[parseInt(e,10),parseInt(i,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var r=ct(e,2),n=r[0],o=r[1];t(n,o)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var r=ct(t,2),n=r[0],o=r[1];e(n,o)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&st(t.prototype,e),r&&st(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function pt(t){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dt(n.key),n)}}function dt(t){var e=function(t,e){if("object"!=pt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pt(e)?e:e+""}var bt=function(){return t=function t(e){var r=e.len,n=e.width,o=e.indexWidth,i=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=r,this.width=n,this.indexWidth=o,this.minWidth=i},(e=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var r=this;return lt.rangeSum(t,e,(function(t){return r.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&vt(t.prototype,e),r&&vt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function mt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return gt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var wt=["en"],St={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",jumpToCell:"Jump to cell",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function Ot(t,e){if(e){var r,n=mt(wt);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(!e[o])break;for(var i=e[o],a=t.match(/(?:\\.|[^.])+/g),l=0;l<a.length;l+=1){var u=i[a[l]];if(!u)break;if(l===a.length-1)return u;i=u}}}catch(t){n.e(t)}finally{n.f()}}}function jt(t){var e=Ot(t,St);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=Ot(t,window.x_spreadsheet.$messages)),e||""}function kt(t){return function(){return jt(t)}}function Pt(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r?wt=[t]:wt.unshift(t),e&&(St[t]=e)}function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Tt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_t(n.key),n)}}function _t(t){var e=function(t,e){if("object"!=Et(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Et(e)?e:e+""}var At={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function Rt(t,e){var r="";if(!t){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];r=jt.apply(void 0,["validation.".concat(e)].concat(o))}return[t,r]}var It=function(){return t=function t(e,r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=r,this.value=n,this.type=e,this.operator=o,this.message=""},(e=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?lt.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,r=this.operator,n=this.value,o=this.type;if(e&&/^\s*$/.test(t))return Rt(!1,"required");if(/^\s*$/.test(t))return[!0];if(At[o]&&!At[o].test(t))return Rt(!1,"notMatch");if("list"===o)return Rt(this.values().includes(t),"notIn");if(r){var i=this.parseValue(t);if("be"===r){var a=xt(n,2),l=a[0],u=a[1];return Rt(i>=this.parseValue(l)&&i<=this.parseValue(u),"between",l,u)}if("nbe"===r){var c=xt(n,2),f=c[0],s=c[1];return Rt(i<this.parseValue(f)||i>this.parseValue(s),"notBetween",f,s)}if("eq"===r)return Rt(i===this.parseValue(n),"equal",n);if("neq"===r)return Rt(i!==this.parseValue(n),"notEqual",n);if("lt"===r)return Rt(i<this.parseValue(n),"lessThan",n);if("lte"===r)return Rt(i<=this.parseValue(n),"lessThanEqual",n);if("gt"===r)return Rt(i>this.parseValue(n),"greaterThan",n);if("gte"===r)return Rt(i>=this.parseValue(n),"greaterThanEqual",n)}return[!0]}}])&&Ct(t.prototype,e),r&&Ct(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Dt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Nt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Nt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function zt(t){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ft(n.key),n)}}function Ht(t,e,r){return e&&Mt(t.prototype,e),r&&Mt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ft(t){var e=function(t,e){if("object"!=zt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=zt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==zt(e)?e:e+""}var Wt=function(){function t(e,r,n){Bt(this,t),this.refs=r,this.mode=e,this.validator=n}return Ht(t,[{key:"includes",value:function(t,e){for(var r=this.refs,n=0;n<r.length;n+=1){if(P.valueOf(r[n]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(P.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(r){var n=P.valueOf(r);n.intersects(t)?n.difference(t).forEach((function(t){return e.push(t.toString())})):e.push(r)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,r=this.validator;return{refs:t,mode:e,type:r.type,required:r.required,operator:r.operator,value:r.value}}}],[{key:"valueOf",value:function(e){var r=e.refs,n=e.mode,o=e.type,i=e.required,a=e.operator,l=e.value;return new t(n,r,new It(o,i,l,a))}}])}(),Vt=function(){return Ht((function t(){Bt(this,t),this._=[],this.errors=new Map}),[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,r){var n=this.get(t,e),o="".concat(t,"_").concat(e),i=this.errors;if(null!==n){var a=Dt(n.validator.validate(r),2),l=a[0],u=a[1];l?i.delete(o):i.set(o,u)}else i.delete(o);return!0}},{key:"add",value:function(t,e,r){var n=r.type,o=r.required,i=r.value,a=r.operator,l=new It(n,o,i,a),u=this.getByValidator(l);null!==u?u.addRef(e):this._.push(new Wt(t,[e],l))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var r=this._[e];if(r.validator.equals(t))return r}return null}},{key:"get",value:function(t,e){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(t,e))return n}return null}},{key:"remove",value:function(t){this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return Wt.valueOf(t)}))}}])}();function Ut(t){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $t(t){return function(t){if(Array.isArray(t))return Yt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Xt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lt(n.key),n)}}function Lt(t){var e=function(t,e){if("object"!=Ut(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ut(e)?e:e+""}function Jt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||Xt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xt(t,e){if(t){if("string"==typeof t)return Yt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yt(t,e):void 0}}function Yt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Zt={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,saveHistory:!0,negativeColor:"#000000",row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:40},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function Kt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=this.merges,o=e.clone(),i=t.size(),a=Jt(i,2),l=a[0],u=a[1],c=e.size(),f=Jt(c,2),s=f[0],h=f[1];return l>s&&(o.eri=e.sri+l-1),u>h&&(o.eci=e.sci+u-1),!n.intersects(o)||(r(jt("error.pasteForMergedCell")),!1)}function Gt(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.rows,i=this.merges;"all"!==r&&"format"!==r||(o.deleteCells(e,r),i.deleteWithin(e)),o.copyPaste(t,e,r,n,(function(t,e,r){if(r&&r.merge){var n=Jt(r.merge,2),o=n[0],a=n[1];if(o<=0&&a<=0)return;i.add(new P(t,e,t+o,e+a))}}))}function Qt(t,e){var r=this.clipboard,n=this.rows,o=this.merges;n.cutPaste(t,e),o.move(t,e.sri-t.sri,e.sci-t.sci),r.clear()}function te(t,e,r){var n=this.styles,o=this.rows.getCellOrNew(t,e),i={};void 0!==o.style&&(i=lt.cloneDeep(n[o.style])),i=lt.merge(i,{border:r}),o.style=this.addStyle(i)}function ee(t){var e=this,r=t.mode,n=t.style,o=t.color,i=this.styles,a=this.selector,l=this.rows,u=a.range,c=u.sri,f=u.sci,s=u.eri,h=u.eci,y=!this.isSingleSelected();if(y||"inside"!==r&&"horizontal"!==r&&"vertical"!==r)if("outside"!==r||y){if("none"===r)a.range.each((function(t,r){var n=l.getCell(t,r);if(n&&void 0!==n.style){var o=lt.cloneDeep(i[n.style]);delete o.border,n.style=e.addStyle(o)}}));else if("all"===r||"inside"===r||"outside"===r||"horizontal"===r||"vertical"===r)for(var p=[],v=c;v<=s;v+=1)for(var d=f;d<=h;d+=1){for(var b=[],m=0;m<p.length;m+=1){var g=Jt(p[m],4),w=g[0],S=g[1],O=g[2],j=g[3];if(v===w+O+1&&b.push(m),w<=v&&v<=w+O&&d===S){d+=j+1;break}}if(b.forEach((function(t){return p.splice(t,1)})),d>h)break;var k=l.getCell(v,d),P=0,E=0;if(k&&k.merge){var x=Jt(k.merge,2);P=x[0],E=x[1],p.push([v,d,P,E])}var T=P>0&&v+P===s,C=E>0&&d+E===h,_={};"all"===r?_={bottom:[n,o],top:[n,o],left:[n,o],right:[n,o]}:"inside"===r?(!C&&d<h&&(_.right=[n,o]),!T&&v<s&&(_.bottom=[n,o])):"horizontal"===r?!T&&v<s&&(_.bottom=[n,o]):"vertical"===r?!C&&d<h&&(_.right=[n,o]):"outside"===r&&y&&(c===v&&(_.top=[n,o]),(T||s===v)&&(_.bottom=[n,o]),f===d&&(_.left=[n,o]),(C||h===d)&&(_.right=[n,o])),Object.keys(_).length>0&&te.call(this,v,d,_),d+=E}else if("top"===r||"bottom"===r)for(var A=f;A<=h;A+=1)"top"===r&&(te.call(this,c,A,{top:[n,o]}),A+=l.getCellMerge(c,A)[1]),"bottom"===r&&(te.call(this,s,A,{bottom:[n,o]}),A+=l.getCellMerge(s,A)[1]);else if("left"===r||"right"===r)for(var R=c;R<=s;R+=1)"left"===r&&(te.call(this,R,f,{left:[n,o]}),R+=l.getCellMerge(R,f)[0]),"right"===r&&(te.call(this,R,h,{right:[n,o]}),R+=l.getCellMerge(R,h)[0])}else te.call(this,c,f,{top:[n,o],bottom:[n,o],left:[n,o],right:[n,o]})}function re(t,e){var r=this.rows,n=this.freezeTotalHeight(),o=r.height;n+r.height<t&&(o-=e);for(var i=this.exceptRowSet,a=0,l=o,u=r.height;a<r.len&&!(l>t);a+=1)i.has(a)||(l+=u=r.getHeight(a));return(l-=u)<=0?{ri:-1,top:0,height:u}:{ri:a-1,top:l,height:u}}function ne(t,e){var r=this.cols,n=this.freezeTotalWidth(),o=r.indexWidth;n+r.indexWidth<t&&(o-=e);var i=Jt(lt.rangeReduceIf(0,r.len,o,r.indexWidth,t,(function(t){return r.getWidth(t)})),3),a=i[0],l=i[1],u=i[2];return l<=0?{ci:-1,left:0,width:r.indexWidth}:{ci:a-1,left:l,width:u}}var oe=function(){return t=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=lt.merge(Zt,r||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new rt,this.rows=new yt(this.settings.row,n),this.cols=new bt(this.settings.col),this.validations=new Vt,this.hyperlinks={},this.comments={},this.selector=new C,this.scroll=new D,this.history=new H(this.settings.saveHistory),this.clipboard=new U,this.autoFilter=new K,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map},(e=[{key:"addValidation",value:function(t,e,r){var n=this;this.changeData((function(){n.validations.add(t,e,r)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=this.validations.get(e,r);return n?n.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=t.range,o=this.validations.get(e,r),i={ref:n.toString()};return null!==o&&(i.mode=o.mode,i.validator=o.validator),i}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],r=this.selector.range,n=r.sri,o=r.eri,i=r.sci,a=r.eci,l=n;l<=o;l+=1){for(var u=[],c=i;c<=a;c+=1){var f=this.getCell(l,c);u.push(f&&f.text||"")}e.push(u)}e=e.map((function(t){return t.join("\t")})).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then((function(){}),(function(t){console.log("text copy to the system clipboard error  ",e,t)}))}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.clipboard,o=this.selector;return!n.isClear()&&!!Kt.call(this,n.range,o.range,r)&&(this.changeData((function(){n.isCopy()?Gt.call(t,n.range,o.range,e):n.isCut()&&Qt.call(t,n.range,o.range)})),!0)}},{key:"pasteFromSystemClipboard",value:function(t,e){var r=this,n=this.selector;navigator.clipboard.readText().then((function(o){var i=r.parseClipboardContent(o),a=n.ri;i.forEach((function(t){var e=n.ci;t.forEach((function(t){r.setCellText(a,e,t,"input"),e+=1})),a+=1})),t(),e(r.rows.getData())}))}},{key:"parseClipboardContent",value:function(t){var e=[],r=t.split("\n"),n=0;return r.forEach((function(t){e[n]=t.split("\t"),n+=1})),e}},{key:"pasteFromText",value:function(t){var e=[];if((e=/\r\n/.test(t)?t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")})):t.split("\n").map((function(t){return t.replace(/"/g,"").split("\t")}))).length){var r=this.rows,n=this.selector;this.changeData((function(){r.paste(e,n.range)}))}}},{key:"autofill",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=this.selector.range;return!!Kt.call(this,o,t,n)&&(this.changeData((function(){Gt.call(r,o,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var r=this.selector,n=this.rows,o=this.cols,i=this.merges,a=r.range,l=a.sri,u=a.sci,c=a.eri,f=a.eci,s=r.ri,h=r.ci,y=t,p=e;return t<0&&(y=n.len-1),e<0&&(p=o.len-1),y>s?(l=s,c=y):(l=y,c=s),p>h?(u=h,f=p):(u=p,f=h),r.range=i.union(new P(l,u,c,f)),r.range=i.union(r.range),r.range}},{key:"calSelectedRangeByStart",value:function(t,e){var r=this.selector,n=this.rows,o=this.cols,i=this.merges.getFirstIncludes(t,e);return null===i&&(i=new P(t,e,t,e),-1===t&&(i.sri=0,i.eri=n.len-1),-1===e&&(i.sci=0,i.eci=o.len-1)),r.range=i,i}},{key:"setSelectedCellAttr",value:function(t,e){var r=this;this.changeData((function(){var n=r.selector,o=r.styles,i=r.rows;if("merge"===t)e?r.merge():r.unmerge();else if("border"===t)ee.call(r,e);else if("formula"===t){var a=n.ri,l=n.ci,u=n.range;if(n.multiple()){var c=Jt(n.size(),2),f=c[0],s=c[1],h=u.sri,y=u.sci,p=u.eri,v=u.eci;if(f>1)for(var d=y;d<=v;d+=1)i.getCellOrNew(p+1,d).text="=".concat(e,"(").concat(b(d,h),":").concat(b(d,p),")");else s>1&&(i.getCellOrNew(a,v+1).text="=".concat(e,"(").concat(b(y,a),":").concat(b(v,a),")"))}else i.getCellOrNew(a,l).text="=".concat(e,"()")}else n.range.each((function(n,a){var l=i.getCellOrNew(n,a),u={};if(void 0!==l.style&&(u=lt.cloneDeep(o[l.style])),"format"===t)u.format=e,l.style=r.addStyle(u);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var c={};c[t.split("-")[1]]=e,u.font=Object.assign(u.font||{},c),l.style=r.addStyle(u)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(u[t]=e,l.style=r.addStyle(u)):l[t]=e}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=this.autoFilter,n=this.selector,o=this.rows,i=n.ri,a=n.ci,l=i;this.unsortedRowMap.has(i)&&(l=this.unsortedRowMap.get(i));var u=o.getCell(l,a),c=u?u.text:"";if(this.setCellText(l,a,t,e),r.active()){var f=r.getFilter(a);if(f){var s=f.value.findIndex((function(t){return t===c}));s>=0&&f.value.splice(s,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=e;return this.unsortedRowMap.has(e)&&(n=this.unsortedRowMap.get(e)),this.rows.getCell(n,r)}},{key:"xyInSelectedRect",value:function(t,e){var r=this.getSelectedRect(),n=r.left,o=r.top,i=r.width,a=r.height,l=t-this.cols.indexWidth,u=e-this.rows.height;return l>n&&l<n+i&&u>o&&u<o+a}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,r=this.rows,n=this.cols,o=this.exceptRowSet,i=t.sri,a=t.sci,l=t.eri,u=t.eci;if(i<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var c=n.sumWidth(0,a),f=r.sumHeight(0,i,o),s=r.sumHeight(i,l+1,o),h=n.sumWidth(a,u+1),y=c-e.x,p=f-e.y,v=this.freezeTotalHeight(),d=this.freezeTotalWidth();return d>0&&d>c&&(y=c),v>0&&v>f&&(p=f),{l:c,t:f,left:y,top:p,height:s,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var r=this.scroll,n=this.merges,o=this.rows,i=this.cols,a=re.call(this,e,r.y),l=a.ri,u=a.top,c=a.height,f=ne.call(this,t,r.x),s=f.ci,h=f.left,y=f.width;if(-1===s&&(y=i.totalWidth()),-1===l&&(c=o.totalHeight()),l>=0||s>=0){var p=n.getFirstIncludes(l,s);if(p){l=p.sri,s=p.sci;var v=this.cellRect(l,s);h=v.left,u=v.top,y=v.width,c=v.height}}return{ri:l,ci:s,left:h,top:u,width:y,height:c}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,o=t.eci,i=this.getCell(e,r);if(i&&i.merge){var a=Jt(i.merge,2),l=a[0],u=a[1];if(e+l===n&&r+u===o)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,o=t.eci,i=this.getCell(e,r);if(i&&i.merge){var a=Jt(i.merge,2),l=a[0],u=a[1];if(e+l===n&&r+u===o)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,r=this.rows;if(!this.isSingleSelected()){var n=Jt(e.size(),2),o=n[0],i=n[1];if(o>1||i>1){var a=e.range,l=a.sri,u=a.sci;this.changeData((function(){var n=r.getCellOrNew(l,u);n.merge=[o-1,i-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(l,u,n)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var r=e.range,n=r.sri,o=r.sci;this.changeData((function(){t.rows.deleteCell(n,o,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,r=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=r.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,r,n){var o=this.autoFilter;o.addFilter(t,r,n),o.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,r=this.rows;if(e.active()){var n=e.sort,o=e.filteredRows((function(t,e){return r.getCell(t,e)})),i=o.rset,a=o.fset,l=Array.from(a),u=Array.from(a);n&&l.sort((function(t,e){return"asc"===n.order?t-e:"desc"===n.order?e-t:0})),this.exceptRowSet=i,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,l.forEach((function(e,r){t.sortedRowMap.set(u[r],e),t.unsortedRowMap.set(e,u[r])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=this.selector;this.changeData((function(){t.rows.deleteCells(r.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(r.range)}))}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var n=e.selector.range,o=n.sri,i=n.sci,a=e.rows,l=e.merges,u=e.cols,c=o;"row"===t?a.insert(o,r):"column"===t&&(a.insertColumn(i,r),c=i,u.len+=1),l.shift(t,c,r,(function(t,e,r,n){var o=a.getCell(t,e);o.merge[0]+=r,o.merge[1]+=n}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var r=e.rows,n=e.merges,o=e.selector,i=e.cols,a=o.range,l=o.range,u=l.sri,c=l.sci,f=l.eri,s=l.eci,h=Jt(o.range.size(),2),y=h[0],p=h[1],v=u,d=y;"row"===t?r.delete(u,f):"column"===t&&(r.deleteColumn(c,s),v=a.sci,d=p,i.len-=s-c+1),n.shift(t,v,-d,(function(t,e,n,o){var i=r.getCell(t,e);i.merge[0]+=n,i.merge[1]+=o,0===i.merge[0]&&0===i.merge[1]&&delete i.merge}))}))}},{key:"scrollx",value:function(t,e){var r=this.scroll,n=this.freeze,o=this.cols,i=Jt(n,2)[1],a=Jt(lt.rangeReduceIf(i,o.len,0,0,t,(function(t){return o.getWidth(t)})),3),l=a[0],u=a[1],c=(a[2],u);t>0&&(c=t),r.x!==c&&(r.ci=t>0?l:0,r.x=c,e())}},{key:"scrolly",value:function(t,e){var r=this.scroll,n=this.freeze,o=this.rows,i=Jt(n,1)[0],a=Jt(lt.rangeReduceIf(i,o.len,0,0,t,(function(t){return o.getHeight(t)})),3),l=a[0],u=a[1],c=(a[2],u);t>0&&(c=t),r.y!==c&&(r.ri=t>0?l:0,r.y=c,e())}},{key:"cellRect",value:function(t,e){var r=this.rows,n=this.cols,o=n.sumWidth(0,e),i=r.sumHeight(0,t),a=r.getCell(t,e),l=n.getWidth(e),u=r.getHeight(t);if(null!==a&&a.merge){var c=Jt(a.merge,2),f=c[0],s=c[1];if(f>0)for(var h=1;h<=f;h+=1)u+=r.getHeight(t+h);if(s>0)for(var y=1;y<=s;y+=1)l+=n.getWidth(e+y)}return{left:o,top:i,width:l,height:u,cell:a}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var r=this.getCell(t,e);return r&&r.text?r.text:""}},{key:"getCellStyle",value:function(t,e){var r=this.getCell(t,e);return r&&void 0!==r.style?this.styles[r.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var r=this.styles,n=this.rows.getCell(t,e),o=n&&void 0!==n.style?r[n.style]:{};return lt.merge(this.defaultStyle(),o)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,r=t.ci;return this.getCellStyleOrDefault(e,r)}},{key:"setCellText",value:function(t,e,r,n){var o=this.rows,i=this.history,a=this.validations;"finished"===n?(o.setCellText(t,e,""),i.add(this.getData()),o.setCellText(t,e,r)):(o.setCellText(t,e,r),this.change(this.getData())),a.validate(t,e,r)}},{key:"freezeIsActive",value:function(){var t=Jt(this.freeze,2),e=t[0],r=t[1];return e>0||r>0}},{key:"setFreeze",value:function(t,e){var r=this;this.changeData((function(){r.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var r=this;this.changeData((function(){r.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var r=this;this.changeData((function(){r.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,r=t.showToolbar,n=t.showBottomBar,o=e.height();return n&&(o-=41),r&&(o-=41),o}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=Jt(this.freeze,2),e=t[0],r=t[1];return new P(0,0,e-1,r-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,r=Jt(t.maxCell(),2),n=r[0],o=r[1],i=t.sumHeight(0,n+1),a=e.sumWidth(0,o+1);return new P(0,0,n,o,a,i)}},{key:"exceptRowTotalHeight",value:function(t,e){var r=this.exceptRowSet,n=this.rows,o=Array.from(r),i=0;return o.forEach((function(r){if(r<t||r>e){var o=n.getHeight(r);i+=o}})),i}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,r=this.cols,n=this.freeze,o=this.exceptRowSet,i=t.ri,a=t.ci;i<=0&&(i=Jt(n,1)[0]),a<=0&&(a=Jt(n,2)[1]);for(var l=0,u=0,c=[e.len,r.len],f=c[0],s=c[1],h=[this.viewWidth(),this.viewHeight()],y=h[0],p=h[1],v=i;v<e.len&&(o.has(v)||(u+=e.getHeight(v),f=v),!(u>p));v+=1);for(var d=a;d<r.len&&(s=d,!((l+=r.getWidth(d))>y));d+=1);return new P(i,a,f,s,y,p)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,r=this.selector,n=Jt(r.size(),2),o=n[0],i=n[1],a=r.range,l=a.sri,u=a.sci,c=a.eri,f=a.eci;if(o===t.len)for(var s=u;s<=f;s+=1)e.setHide(s,!0);else if(i===e.len)for(var h=l;h<=c;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,r){for(var n=0,o=this.rows,i=this.exceptRowSet,a=$t(i),l=0,u=0;u<a.length;u+=1)a[u]<t&&(l+=1);for(var c=t+l;c<=e+l;c+=1)if(i.has(c))l+=1;else{var f=o.getHeight(c);f>0&&(r(c,n,f),n+=f)}}},{key:"colEach",value:function(t,e,r){for(var n=0,o=this.cols,i=t;i<=e;i+=1){var a=o.getWidth(i);a>0&&(r(i,n,a),n+=a)}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,r=0;r<e.length;r+=1){var n=e[r];if(lt.equals(n,t))return r}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(r){if("merges"===r||"rows"===r||"cols"===r||"validations"===r)e[r].setData(t[r]);else if("freeze"===r){var n=Jt(d(t[r]),2),o=n[0],i=n[1];e.freeze=[i,o]}else"autofilter"===r?e.autoFilter.setData(t[r]):void 0!==t[r]&&(e[r]=t[r])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,r=this.styles,n=this.merges,o=this.rows,i=this.cols,a=this.validations,l=this.autoFilter;return{name:t,freeze:b(e[1],e[0]),styles:r,merges:n.getData(),rows:o.getData(),cols:i.getData(),validations:a.getData(),autofilter:l.getData()}}}])&&qt(t.prototype,e),r&&qt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function ie(t){return function(t){if(Array.isArray(t))return le(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ae(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(t,e){if(t){if("string"==typeof t)return le(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?le(t,e):void 0}}function le(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ue(t,e,r){t.addEventListener(e,r)}function ce(t,e,r){t.removeEventListener(e,r)}function fe(t){t.xclickoutside&&(ce(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function se(t,e){t.xclickoutside=function(r){2===r.detail||t.contains(r.target)||(e?e(t):(t.hide(),fe(t)))},ue(window.document.body,"click",t.xclickoutside)}function he(t,e,r){ue(t,"mousemove",e),t.xEvtUp=function(n){ce(t,"mousemove",e),ce(t,"mouseup",t.xEvtUp),r(n)},ue(t,"mouseup",t.xEvtUp)}function ye(){var t=new Map;function e(e,r){var n;return t.has(e)&&(n=t.get(e),Array.isArray(n)&&n.push(r)||!1)||t.set(e,[].concat(r))}function r(e,r){var n,o;return t.has(e)&&(n=t.get(e),(o=n.indexOf(r))>=0&&n.splice(o,1)&&0===t.get(e).length&&t.delete(e))}return{get current(){return t},on:e,once:function(t,n){var o=function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];n.call.apply(n,[null].concat(i)),r(t,o)};return e(t,o)},fire:function(e,r){return t.has(e)&&function(){var n,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=ae(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){l=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t.get(e));try{for(o.s();!(n=o.n()).done;){var i=n.value;i.call.apply(i,[null].concat(ie(r)))}}catch(t){o.e(t)}finally{o.f()}}()},removeListener:r,removeAllListeners:function(){t.clear()}}}var pe="x-spreadsheet";window.devicePixelRatio;function ve(t){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function de(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function be(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,me(n.key),n)}}function me(t){var e=function(t,e){if("object"!=ve(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ve(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ve(e)?e:e+""}var ge=function(){return t=function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;de(this,t),this.moving=!1,this.vertical=r,this.el=f("div","".concat(pe,"-resizer ").concat(r?"vertical":"horizontal")).children(this.unhideHoverEl=f("div","".concat(pe,"-resizer-hover")).on("dblclick.stop",(function(t){return e.mousedblclickHandler(t)})).css("position","absolute").hide(),this.hoverEl=f("div","".concat(pe,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=f("div","".concat(pe,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n,this.unhideFn=function(){}},(e=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var r=this.moving,n=this.vertical,o=this.hoverEl,i=this.lineEl,a=this.el,l=this.unhideHoverEl;if(!r){this.cRect=t;var u=t.left,c=t.top,f=t.width,s=t.height;a.offset({left:n?u+f-5:u,top:n?c:c+s-5}).show(),o.offset({width:n?5:f,height:n?s:5}),i.offset({width:n?0:e.width,height:n?e.height:0}),l.offset({left:n?5-f:u,top:n?c:5-s,width:n?5:f,height:n?s:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,r=t,n=this.el,o=this.lineEl,i=this.cRect,a=this.vertical,l=this.minDistance,u=a?i.width:i.height;o.show(),he(window,(function(t){e.moving=!0,null!==r&&1===t.buttons&&(a?(u+=t.movementX)>l&&n.css("left","".concat(i.left+u,"px")):(u+=t.movementY)>l&&n.css("top","".concat(i.top+u,"px")),r=t)}),(function(){r=null,o.hide(),e.moving=!1,e.hide(),e.finishedFn&&(u<l&&(u=l),e.finishedFn(i,u))}))}}])&&be(t.prototype,e),r&&be(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function we(t){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Se(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ke(n.key),n)}}function je(t,e,r){return e&&Oe(t.prototype,e),r&&Oe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ke(t){var e=function(t,e){if("object"!=we(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=we(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==we(e)?e:e+""}var Pe=10,Ee=function(){return je((function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Se(this,t),this.useHideInput=r,this.autoFocus=n,this.inputChange=function(){},this.cornerEl=f("div","".concat(pe,"-selector-corner")),this.areaEl=f("div","".concat(pe,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=f("div","".concat(pe,"-selector-clipboard")).hide(),this.autofillEl=f("div","".concat(pe,"-selector-autofill")).hide(),this.el=f("div","".concat(pe,"-selector")).css("z-index","".concat(Pe)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),r&&(this.hideInput=f("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=f("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=f("div","hide-input").child(this.hideInput))),Pe+=1}),[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,r=t.top,n={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:r-.8};this.areaEl.offset(n).show(),this.useHideInput&&(this.hideInputDiv.offset(n),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"setClipboardOffset",value:function(t){var e=t.left,r=t.top,n=t.width,o=t.height;this.clipboardEl.offset({left:e,top:r,width:n-5,height:o-5})}},{key:"showAutofill",value:function(t){var e=t.left,r=t.top,n=t.width,o=t.height;this.autofillEl.offset({width:n-3,height:o-3,left:e,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}])}();function xe(t){var e=this.data,r=t.left,n=t.top,o=t.width,i=t.height,a=t.scroll,l=t.l,u=t.t,c=e.freezeTotalWidth(),f=e.freezeTotalHeight(),s=r-c;c>l&&(s-=a.x);var h=n-f;return f>u&&(h-=a.y),{left:s,top:h,width:o,height:i}}function Te(t){var e=this.data,r=t.left,n=t.width,o=t.height,i=t.l,a=t.t,l=t.scroll,u=e.freezeTotalWidth(),c=r-u;return u>i&&(c-=l.x),{left:c,top:a,width:n,height:o}}function Ce(t){var e=this.data,r=t.top,n=t.width,o=t.height,i=t.l,a=t.t,l=t.scroll,u=e.freezeTotalHeight(),c=r-u;return u>a&&(c-=l.y),{left:i,top:c,width:n,height:o}}function _e(t){this.br.setAreaOffset(xe.call(this,t))}function Ae(t){var e=t.l,r=t.t,n=t.width,o=t.height;this.tl.setAreaOffset({left:e,top:r,width:n,height:o})}function Re(t){this.t.setAreaOffset(Te.call(this,t))}function Ie(t){this.l.setAreaOffset(Ce.call(this,t))}function De(t){this.l.setClipboardOffset(Ce.call(this,t))}function Ne(t){this.br.setClipboardOffset(xe.call(this,t))}function ze(t){this.tl.setClipboardOffset(t)}function Be(t){this.t.setClipboardOffset(Te.call(this,t))}function Me(t){_e.call(this,t),Ae.call(this,t),Re.call(this,t),Ie.call(this,t)}function He(t){Ne.call(this,t),ze.call(this,t),Be.call(this,t),De.call(this,t)}var Fe=function(){return je((function t(e){var r=this;Se(this,t);var n=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.br=new Ee(!0,n),this.t=new Ee,this.l=new Ee,this.tl=new Ee,this.br.inputChange=function(t){r.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=f("div","".concat(pe,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Pe+=1}),[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,r=this.t,n=this.l,o=this.br,i=t.freezeTotalHeight(),a=t.freezeTotalWidth();i>0||a>0?(e.setOffset({width:a,height:i}),r.setOffset({left:a,height:i}),n.setOffset({top:i,width:a}),o.setOffset({left:a,top:i})):(e.hide(),r.hide(),n.hide(),o.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Me.call(this,t),He.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();_e.call(this,t),Re.call(this,t),Ne.call(this,e),Be.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();_e.call(this,t),Ie.call(this,t),Ne.call(this,e),De.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,o=n.calSelectedRangeByStart(t,e),i=o.sri,a=o.sci;if(r){var l=t,u=e;t<0&&(l=0),e<0&&(u=0),n.selector.setIndexes(l,u),this.indexes=[l,u]}this.moveIndexes=[i,a],this.range=o,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,o=this.lastri,i=this.lastci;if(r){if(t===o&&e===i)return;this.lastri=t,this.lastci=e}this.range=n.calSelectedRangeByEnd(t,e),Me.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,r=t.eci;this.setEnd(e,r)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var r=this.range,n=r.sri,o=r.sci,i=r.eri,a=r.eci,l=t,u=e,c=n-t,f=i-t,s=a-e;if(o-e>0)this.arange=new P(n,u,i,o-1);else if(c>0)this.arange=new P(l,o,n-1,a);else if(s<0)this.arange=new P(n,a+1,i,u);else{if(!(f<0))return void(this.arange=null);this.arange=new P(i+1,o,l,a)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var y=this.br,p=this.l,v=this.t,d=this.tl;y.showAutofill(xe.call(this,h)),p.showAutofill(Ce.call(this,h)),v.showAutofill(Te.call(this,h)),d.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();He.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}])}();function We(t){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ve(t){return function(t){if(Array.isArray(t))return Ue(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ue(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ue(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Le(n.key),n)}}function Le(t){var e=function(t,e){if("object"!=We(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=We(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==We(e)?e:e+""}function Je(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function Xe(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function Ye(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function Ze(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:Je.call(this,t);break;case 39:t.stopPropagation();break;case 40:Xe.call(this,t);break;case 13:case 9:Ye.call(this,t);break;default:t.stopPropagation()}}var Ke=function(){return t=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";$e(this,t),this.filterItems=[],this.items=e,this.el=f("div","".concat(pe,"-suggest")).css("width",n).hide(),this.itemClick=r,this.itemIndex=-1},(e=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),fe(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,r=this,n=this.items;if(/^\s*$/.test(t)||(n=n.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),n=n.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var n=f("div","".concat(pe,"-item")).child(e).on("click.stop",(function(){r.itemClick(t),r.hide()}));return t.label&&n.child(f("div","label").html(t.label)),n})),this.filterItems=n,!(n.length<=0)){var o=this.el;(e=o.html("")).children.apply(e,Ve(n)).show(),se(o.parent(),(function(){r.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return Ze.call(e,t)}))}}])&&qe(t.prototype,e),r&&qe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ge(t){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tr(n.key),n)}}function tr(t){var e=function(t,e){if("object"!=Ge(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ge(e)?e:e+""}function er(t,e,r){return e=rr(e),function(t,e){if(e&&("object"==Ge(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],rr(t).constructor):e.apply(t,r))}function rr(t){return(rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nr(t,e){return(nr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var or=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=er(this,e,["div","".concat(pe,"-icon")])).iconNameEl=f("div","".concat(pe,"-icon-img ").concat(t)),r.child(r.iconNameEl),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nr(t,e)}(e,t),r=e,(n=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(pe,"-icon-img ").concat(t))}}])&&Qe(r.prototype,n),o&&Qe(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c);function ir(t){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ar(t){return function(t){if(Array.isArray(t))return lr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return lr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ur(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cr(n.key),n)}}function cr(t){var e=function(t,e){if("object"!=ir(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ir(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ir(e)?e:e+""}function fr(t,e){t.setMonth(t.getMonth()+e)}function sr(t,e){var r=new Date(t);return r.setDate(e-t.getDay()+1),r}var hr=function(){return t=function t(e){var r,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=f("div","calendar-header-left"),this.bodyEl=f("tbody",""),this.buildAll(),this.el=f("div","x-spreadsheet-calendar").children(f("div","calendar-header").children(this.headerLeftEl,f("div","calendar-header-right").children(f("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new or("chevron-left")),f("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new or("chevron-right")))),f("table","calendar-body").children(f("thead","").child((r=f("tr","")).children.apply(r,ar(jt("calendar.weeks").map((function(t){return f("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}},(e=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){fr(this.value,-1),this.buildAll()}},{key:"next",value:function(){fr(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(jt("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,r=this.value,n=this.cvalue,o=this.bodyEl,i=function(t,e,r){for(var n=new Date(t,e,1,23,59,59),o=[[],[],[],[],[],[]],i=0;i<6;i+=1)for(var a=0;a<7;a+=1){var l=sr(n,7*i+a),u=l.getMonth()!==e,c=l.getMonth()===r.getMonth()&&l.getDate()===r.getDate();o[i][a]={d:l,disabled:u,active:c}}return o}(r.getFullYear(),r.getMonth(),n).map((function(t){var r,n=t.map((function(t){var r="cell";return t.disabled&&(r+=" disabled"),t.active&&(r+=" active"),f("td","").child(f("div",r).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(r=f("tr","")).children.apply(r,ar(n))}));(t=o.html("")).children.apply(t,ar(i))}}])&&ur(t.prototype,e),r&&ur(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function yr(t){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vr(n.key),n)}}function vr(t){var e=function(t,e){if("object"!=yr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yr(e)?e:e+""}var dr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new hr(new Date),this.el=f("div","".concat(pe,"-datepicker")).child(this.calendar.el).hide()},(e=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(r){t(r),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&pr(t.prototype,e),r&&pr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function br(t){return(br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Or(n.key),n)}}function gr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function wr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?gr(Object(r),!0).forEach((function(e){Sr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Sr(t,e,r){return(e=Or(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Or(t){var e=function(t,e){if("object"!=br(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=br(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==br(e)?e:e+""}function jr(t){return function(t){if(Array.isArray(t))return kr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return kr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?kr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Pr(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,r=this.textEl,n=this.areaOffset,o=t.split("\n"),i=Math.max.apply(Math,jr(o.map((function(t){return t.length})))),a=e.offset().width/t.length,l=(i+1)*a+5,u=this.viewFn().width-n.left-a,c=o.length;if(l>n.width){var f=l;l>u&&(f=u,c+=parseInt(l/u,10),c+=l%u>0?1:0),r.css("width","".concat(f,"px"))}(c*=this.rowHeight)>n.height&&r.css("height","".concat(c,"px"))}}function Er(t,e){var r=t.target,n=r.value,o=r.selectionEnd,i="".concat(n.slice(0,o)).concat(e).concat(n.slice(o));r.value=i,r.setSelectionRange(o+1,o+1),this.inputText=i,this.textlineEl.html(i),Pr.call(this)}function xr(t){var e=t.keyCode,r=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&r&&(Er.call(this,t,"\n"),t.stopPropagation()),13!==e||r||t.preventDefault()}function Tr(t){var e=t.target.value,r=this.suggest,n=this.textlineEl,o=this.validator,i=this.cell;if(null!==i)if("editable"in i&&!0===i.editable||void 0===i.editable){if(this.inputText=e,o)"list"===o.type?r.search(e):r.hide();else{var a=e.lastIndexOf("=");-1!==a?r.search(e.substring(a+1)):r.hide()}n.html(e),Pr.call(this),this.change("input",e)}else t.target.value=i.text||"";else{if(this.inputText=e,o)"list"===o.type?r.search(e):r.hide();else{var l=e.lastIndexOf("=");-1!==l?r.search(e.substring(l+1)):r.hide()}n.html(e),Pr.call(this),this.change("input",e)}}function Cr(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function _r(t,e){var r=this.textEl,n=this.textlineEl;r.el.blur(),r.val(t),n.html(t),Cr.call(this,e)}function Ar(t){var e=this.inputText,r=this.validator,n=0;if(r&&"list"===r.type)this.inputText=t,n=this.inputText.length;else{var o=e.lastIndexOf("="),i=e.substring(0,o+1),a=e.substring(o+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(i+t.key,"("),n=this.inputText.length,this.inputText+=")".concat(a)}_r.call(this,this.inputText,n),this.clear()}function Rr(){this.suggest.setItems(this.formulas)}var Ir=function(){return function(t,e,r){return e&&mr(t.prototype,e),r&&mr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e,r,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=r,this.rowHeight=n,this.formulas=e,this.suggest=new Ke(e,(function(t){Ar.call(o,t)})),this.datepicker=new dr,this.datepicker.change((function(t){o.setText(function(t){var e=new Intl.DateTimeFormat("en-US",{day:"numeric",month:"short",year:"numeric"}).formatToParts(t).reduce((function(t,e){return Object(wr(wr({},t),{},Sr({},e.type,e.value)))}),{});return e.day+"-"+e.month+"-"+e.year}(t)),o.clear()})),this.areaEl=f("div","".concat(pe,"-editor-area")).children(this.textEl=f("textarea","").on("input",(function(t){return Tr.call(o,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return xr.call(o,t)})),this.textlineEl=f("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=f("div","".concat(pe,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}),[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),Rr.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r=this.textEl,n=this.areaEl,o=this.suggest,i=this.freeze,a=this.el;if(t){this.areaOffset=t;var l=t.left,u=t.top,c=t.width,f=t.height,s=t.l,h=t.t,y={left:0,top:0};i.w>s&&i.h>h||(i.w<s&&i.h<h?(y.left=i.w,y.top=i.h):i.w>s?y.top=i.h:i.h>h&&(y.left=i.w)),a.offset(y),n.offset({left:l-y.left-.8,top:u-y.top-.8}),r.offset({width:c-9+.8,height:f-3+.8});var p={left:0};p[e]=f,o.setOffset(p),o.hide()}}},{key:"setCell",value:function(t,e){if(!t||!1!==t.editable){var r=this.el,n=this.datepicker,o=this.suggest;r.show(),this.cell=t;var i=t&&t.text||"";if(this.setText(i),this.validator=e,e){var a=e.type;"date"===a&&(n.show(),/^\s*$/.test(i)||n.setValue(i)),"list"===a&&(o.setItems(e.values()),o.search(""))}}}},{key:"setText",value:function(t){this.inputText=t,_r.call(this,t,t.length),Pr.call(this)}}])}();function Dr(t){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zr(n.key),n)}}function zr(t){var e=function(t,e){if("object"!=Dr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Dr(e)?e:e+""}function Br(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mr(t,e,r){return e=Hr(e),function(t,e){if(e&&("object"==Dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Hr(t).constructor):e.apply(t,r))}function Hr(t){return(Hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fr(t,e){return(Fr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Wr=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Br(this,e),(r=Mr(this,e,["div","".concat(pe,"-button ").concat(n)])).child(jt("button.".concat(t))),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fr(t,e)}(e,t),r=e,n&&Nr(r.prototype,n),o&&Nr(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c);function Vr(t){return function(t){if(Array.isArray(t))return qr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||$r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ur(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||$r(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $r(t,e){if(t){if("string"==typeof t)return qr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qr(t,e):void 0}}function qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Lr(t){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zr(n.key),n)}}function Yr(t,e,r){return e&&Xr(t.prototype,e),r&&Xr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zr(t){var e=function(t,e){if("object"!=Lr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Lr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Lr(e)?e:e+""}function Kr(){return window.devicePixelRatio||1}function Gr(){return Kr()-.5}function Qr(t){return Math.round(t*Kr())}function tn(t){return Math.floor(t*Kr())+.5}var en=function(){return Yr((function t(e,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Jr(this,t),this.x=e,this.y=r,this.width=n,this.height=o,this.padding=i,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}),[{key:"setBorders",value:function(t){var e=t.top,r=t.bottom,n=t.left,o=t.right;e&&(this.borderTop=e),o&&(this.borderRight=o),r&&(this.borderBottom=r),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,r=this.padding,n=this.x;return"left"===t?n+=r:"center"===t?n+=e/2:"right"===t&&(n+=e-r),n}},{key:"texty",value:function(t,e){var r=this.height,n=this.padding,o=this.y;return"top"===t?o+=n:"middle"===t?o+=r/2-e/2:"bottom"===t&&(o+=r-n-e),o}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,r=this.width;return[[t+r,e],[t+r,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,r=this.width,n=this.height;return[[t,e+n],[t+r,e+n]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}])}();function rn(t,e,r,n,o,i,a){var l={x:0,y:0};"underline"===t?l.y="bottom"===o?0:"top"===o?-(i+2):-i/2:"strike"===t&&("bottom"===o?l.y=i/2:"top"===o&&(l.y=-(i/2+2))),"center"===n?l.x=a/2:"right"===n&&(l.x=a),this.line([e-l.x,r-l.y],[e-l.x+a,r-l.y])}var nn=function(){return Yr((function t(e,r,n){Jr(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(r,n),this.ctx.scale(Kr(),Kr())}),[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=Qr(t),this.el.height=Qr(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,r=t.height;return this.ctx.clearRect(0,0,e,r),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(Qr(t),Qr(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,r,n){return this.ctx.clearRect(t,e,r,n),this}},{key:"fillRect",value:function(t,e,r,n){return this.ctx.fillRect(Qr(t)-.5,Qr(e)-.5,Qr(r),Qr(n)),this}},{key:"fillText",value:function(t,e,r){return this.ctx.fillText(t,Qr(e),Qr(r)),this}},{key:"text",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.ctx,a=n.align,l=n.valign,u=n.font,c=n.color,f=n.strike,s=n.underline,h=e.textx(a);i.save(),i.beginPath(),this.attr({textAlign:a,textBaseline:l,font:"".concat(u.italic?"italic":""," ").concat(u.bold?"bold":""," ").concat(Qr(u.size),"px ").concat(u.name),fillStyle:c,strokeStyle:c});var y="".concat(t).split("\n"),p=e.innerWidth(),v=[];y.forEach((function(t){var e=i.measureText(t).width;if(o&&e>Qr(p)){for(var r={w:0,len:0,start:0},n=0;n<t.length;n+=1)r.w>=Qr(p)&&(v.push(t.substr(r.start,r.len)),r={w:0,len:0,start:n}),r.len+=1,r.w+=i.measureText(t[n]).width+1;r.len>0&&v.push(t.substr(r.start,r.len))}else v.push(t)}));var d=(v.length-1)*(u.size+2),b=e.texty(l,d);return v.forEach((function(t){var e=i.measureText(t).width;r.fillText(t,h,b),f&&rn.call(r,"strike",h,b,a,l,u.size,e),s&&rn.call(r,"underline",h,b,a,l,u.size,e),b+=u.size+2})),i.restore(),this}},{key:"border",value:function(t,e){var r=this.ctx;return r.lineWidth=Gr,r.strokeStyle=e,"medium"===t?r.lineWidth=Qr(2)-.6:"thick"===t?r.lineWidth=Qr(3):"dashed"===t?r.setLineDash([Qr(3),Qr(2)]):"dotted"===t?r.setLineDash([Qr(1),Qr(1)]):"double"===t&&r.setLineDash([Qr(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],r=Ur(e,2),n=r[0],o=r[1];t.moveTo(tn(n),tn(o));for(var i=1;i<arguments.length;i+=1){var a=i<0||arguments.length<=i?void 0:arguments[i],l=Ur(a,2),u=l[0],c=l[1];t.lineTo(tn(u),tn(c))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var r=t.borderTop,n=t.borderRight,o=t.borderBottom,i=t.borderLeft;r&&(this.border.apply(this,Vr(r)),this.line.apply(this,Vr(t.topxys()))),n&&(this.border.apply(this,Vr(n)),this.line.apply(this,Vr(t.rightxys()))),o&&(this.border.apply(this,Vr(o)),this.line.apply(this,Vr(t.bottomxys()))),i&&(this.border.apply(this,Vr(i)),this.line.apply(this,Vr(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-15,i=n+t.height-15;e.save(),e.beginPath(),e.moveTo(Qr(o),Qr(i)),e.lineTo(Qr(o+8),Qr(i)),e.lineTo(Qr(o+4),Qr(i+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){this.ctx;var e=t.x;t.y,t.width}},{key:"frozen",value:function(t){this.ctx;var e=t.x;t.y,t.width}},{key:"changed",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-1;e.save(),e.beginPath(),e.moveTo(Qr(o-8),Qr(n-1)),e.lineTo(Qr(o),Qr(n-1)),e.lineTo(Qr(o),Qr(n+8)),e.closePath(),e.fillStyle="rgba(150, 0, 232, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var r=this.ctx,n=t.x,o=t.y,i=t.width,a=t.height,l=t.bgcolor;r.save(),r.beginPath(),r.fillStyle=l||"#fff",r.rect(tn(n+1),tn(o+1),Qr(i-2),Qr(a-2)),r.clip(),r.fill(),e(),r.restore()}},{key:"clipRect",value:function(){for(var t=this.ctx,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.rect.apply(t,Vr(r.map(tn))),t.clip(),this}}])}(),on=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],an=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function ln(t){for(var e=0;e<an.length;e+=1){var r=an[e];if(r.pt===t)return r.px}return t}function un(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return cn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?cn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var fn=function(t){for(var e=[],r=[],n=[],o=0,i="",a=1,l="",u=0;u<t.length;u+=1){var c=t.charAt(u);if(" "!==c){if(c>="a"&&c<="z")n.push(c.toUpperCase());else if(c>="0"&&c<="9"||c>="A"&&c<="Z"||"."===c)n.push(c);else if('"'===c){for(u+=1;'"'!==t.charAt(u);)n.push(t.charAt(u)),u+=1;r.push('"'.concat(n.join(""))),n=[]}else if("-"===c&&/[+\-*/,(]/.test(l))n.push(c);else{if("("!==c&&n.length>0&&r.push(n.join("")),")"===c){var f=e.pop();if(2===o)try{for(var s=un(d(r.pop()),2),h=s[0],y=s[1],p=un(d(r.pop()),2),v=p[0],m=p[1],g=0,w=v;w<=h;w+=1)for(var S=m;S<=y;S+=1)r.push(b(w,S)),g+=1;r.push([f,g])}catch(t){}else if(1===o||3===o)3===o&&r.push(i),r.push([f,a]),a=1;else for(;"("!==f&&(r.push(f),!(e.length<=0));)f=e.pop();o=0}else if("="===c||">"===c||"<"===c){var O=t.charAt(u+1);i=c,"="!==O&&"-"!==O||(i+=O,u+=1),o=3}else if(":"===c)o=2;else if(","===c)3===o&&r.push(i),o=1,a+=1;else if("("===c&&n.length>0)e.push(n.join(""));else{if(e.length>0&&("+"===c||"-"===c)){var j=e[e.length-1];if("("!==j&&r.push(e.pop()),"*"===j||"/"===j)for(;e.length>0&&"("!==(j=e[e.length-1]);)r.push(e.pop())}else if(e.length>0){var k=e[e.length-1];"*"!==k&&"/"!==k||r.push(e.pop())}e.push(c)}n=[]}l=c}}for(n.length>0&&r.push(n.join(""));e.length>0;)r.push(e.pop());return r},sn=function(t,e){var r=un(t,1)[0],n=t;if('"'===r)return t.substring(1);var o=1;if("-"===r&&(n=t.substring(1),o=-1),n[0]>="0"&&n[0]<="9")return o*Number(n);var i=un(d(n),2),a=e(i[0],i[1]);return/(\$*)\d*(.*|,*)\d*(hr*|%*)/gm.test(a)?a:o*a},hn=function(t,e,r,n){for(var o=[],i=0;i<t.length;i+=1){var a=t[i],l=a[0];if("+"===a){var u=o.pop();o.push(at("+",o.pop(),u))}else if("-"===a)if(1===o.length){var c=o.pop();o.push(at("*",c,-1))}else{var f=o.pop();o.push(at("-",o.pop(),f))}else if("*"===a)o.push(at("*",o.pop(),o.pop()));else if("/"===a){var s=o.pop();o.push(at("/",o.pop(),s))}else if("="===l||">"===l||"<"===l){var h=o.pop();Number.isNaN(h)||(h=Number(h));var y=o.pop();Number.isNaN(y)||(y=Number(y));var p=!1;"="===l?p=y===h:">"===a?p=y>h:">="===a?p=y>=h:"<"===a?p=y<h:"<="===a&&(p=y<=h),o.push(p)}else if(Array.isArray(a)){for(var v=un(a,2),d=v[0],b=v[1],m=[],g=0;g<b;g+=1)m.push(o.pop());o.push(e[d].render(m.reverse()))}else{if(n.includes(a))return 0;(l>="a"&&l<="z"||l>="A"&&l<="Z")&&n.push(a),o.push(sn(a,r)),n.pop()}}return o[0]},yn=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===t[0]){var o=fn(t.substring(1));return o.length<=0?t:hn(o,e,(function(t,o){return yn(r(t,o),e,r,n)}),n)}return t},pn={render:yn};function vn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||bn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dn(t){return function(t){if(Array.isArray(t))return mn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||bn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bn(t,e){if(t){if("string"==typeof t)return mn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mn(t,e):void 0}}function mn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var gn=[{key:"SUM",title:kt("formula.sum"),render:function(t){return t.reduce((function(t,e){return at("+",t,e)}),0)}},{key:"AVERAGE",title:kt("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:kt("formula.max"),render:function(t){return Math.max.apply(Math,dn(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:kt("formula.min"),render:function(t){return Math.min.apply(Math,dn(t.map((function(t){return Number(t)}))))}},{key:"IF",title:kt("formula._if"),render:function(t){var e=vn(t,3),r=e[0],n=e[1],o=e[2];return r?n:o}},{key:"AND",title:kt("formula.and"),render:function(t){return t.every((function(t){return t}))}},{key:"OR",title:kt("formula.or"),render:function(t){return t.some((function(t){return t}))}},{key:"CONCAT",title:kt("formula.concat"),render:function(t){return t.join("")}}],wn=gn,Sn={};function On(t){return function(t){if(Array.isArray(t))return Pn(t)}(t)||En(t)||kn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(t){return function(t){if(Array.isArray(t))return t}(t)||En(t)||kn(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kn(t,e){if(t){if("string"==typeof t)return Pn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pn(t,e):void 0}}function Pn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function En(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}gn.forEach((function(t){Sn[t.key]=t}));var xn=function(t){return t},Tn=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=jn(Number(t).toFixed(2).toString().split("\\.")),r=e[0],n=e.slice(1);return[r.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(On(n))}return t},Cn=[{key:"normal",title:kt("format.normal"),type:"string",render:xn},{key:"text",title:kt("format.text"),type:"string",render:xn},{key:"number",title:kt("format.number"),type:"number",label:"1,000.12",render:Tn},{key:"percent",title:kt("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:kt("format.rmb"),type:"number",label:"10.00",render:function(t){return"".concat(Tn(t))}},{key:"usd",title:kt("format.usd"),type:"number",label:"$10.00",render:function(t){return t<0?"-$".concat(Tn(-1*t)):"$".concat(Tn(t))}},{key:"eur",title:kt("format.eur"),type:"number",label:"10.00",render:function(t){return"".concat(Tn(t))}},{key:"date",title:kt("format.date"),type:"date",label:"26/09/2008",render:xn},{key:"time",title:kt("format.time"),type:"date",label:"15:59:00",render:xn},{key:"datetime",title:kt("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:xn},{key:"duration",title:kt("format.duration"),type:"date",label:"24:01:00",render:xn}],_n={};function An(t){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return In(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?In(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Dn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nn(n.key),n)}}function Nn(t){var e=function(t,e){if("object"!=An(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=An(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==An(e)?e:e+""}Cn.forEach((function(t){_n[t.key]=t}));var zn={fillStyle:"#f4f5f8"};Gr();function Bn(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t.cellRect(e,r),i=o.left,a=o.top,l=o.width,u=o.height;return new en(i,a+n,l,u,5)}function Mn(t,e,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=e.sortedRowMap,a=e.rows,l=e.cols;if(!a.isHide(r)&&!l.isHide(n)){var u=r;i.has(r)&&(u=i.get(r));var c=e.getCell(u,n);if(null!==c){var f=!1;"editable"in c&&!1===c.editable&&(f=!0);var s=e.getCellStyleOrDefault(u,n),h=Bn(e,r,n,o);h.bgcolor=s.bgcolor,void 0!==s.border&&(h.setBorders(s.border),t.strokeBorders(h)),t.rect(h,(function(){var o="";o=e.settings.evalPaused?c.text||"":pn.render(c.text||"",Sn,(function(t,r){return e.getCellTextOrDefault(r,t)})),s.format&&(o=_n[s.format].render(o));var i=Object.assign({},s.font);i.size=ln(i.size);var a=parseFloat(c.text)<0&&!1!==e.settings.negativeColor?e.settings.negativeColor:s.color;Number.isInteger(o)?a=o<0?e.settings.negativeColor:a:parseFloat(o.replace("$",""))<0&&(a=e.settings.negativeColor),t.text(o,h,{align:s.align,valign:s.valign,font:i,color:a,strike:s.strike,underline:s.underline},s.textwrap),e.validations.getError(r,n)&&t.error(h),f&&t.frozen(h),c.changed&&t.changed(h)}))}}}function Hn(t){var e=this.data,r=this.draw;if(t){var n=e.autoFilter;if(!n.active())return;var o=n.hrange();t.intersects(o)&&o.each((function(t,n){var o=Bn(e,t,n);r.dropdown(o)}))}}function Fn(t,e,r,n,o,i,a){var l=this.draw,u=this.data,c=t.w,f=t.h,s=.5*Gr();l.save(),l.translate(e,r).clipRect(n+s,o+s,c,f).translate(i,a);var h=u.exceptRowSet,y=u.exceptRowTotalHeight(t.sri,t.eri);l.save(),l.translate(0,-y),t.each((function(t,e){Mn(l,u,t,e)}),(function(t){return function(t){var e=h.has(t);if(e){var r=u.rows.getHeight(t);l.translate(0,-r)}return!e}(t)})),l.restore();var p=new Set;l.save(),l.translate(0,-y),u.eachMergesInView(t,(function(t){var e=t.sri,r=t.sci,n=t.eri;if(h.has(e)){if(!p.has(e)){p.add(e);var o=u.rows.sumHeight(e,n+1);l.translate(0,-o)}}else Mn(l,u,e,r)})),l.restore(),Hn.call(this,t),l.restore()}function Wn(t,e,r,n){var o=this.draw;o.save(),o.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,r,n),o.restore()}function Vn(t,e){var r=this.draw;r.save().ctx.globalCompositeOperation="destination-over",r.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),r.restore()}function Un(t,e,r,n,o,i,a){var l=this,u=t.sri,c=t.sci,f=t.eri,s=t.eci,h=t.w,y=t.h,v=this.draw,d=this.data,b=(d.settings,d.contSize),m=d.freeze,g=b.width,w=b.height,S=[0,0],O=d.selector.range;v.save(),v.attr(zn),v.fillRect(0,r,e,y),v.fillRect(e,0,h,r),v.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(Qr(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Gr(),strokeStyle:"#e6e6e6"}).clipRect(0,0,e+g,r+w).save().translate(0,r),d.rowEach(0,f,(function(t,r,n){if(t>=m[0]&&!S[0]++&&v.line([0,r],[h,r]).clipRect(0,r,h,y),t>=u)r+=a;else if(t>=m[0])return;O.sri<=t&&t<=O.eri&&Wn.call(l,0,r,e,n),v.fillText(t+1,e/2,r+n/2),t>0&&d.rows.isHide(t-1)&&(v.save(),v.attr({strokeStyle:"#c6c6c6"}),v.line([5,r+5],[e-5,r+5]),v.restore()),v.line([0,r],[h,r]),t===f&&v.line([0,r+n],[h,r+n])})),v.restore().translate(e,0),d.colEach(0,s,(function(t,e,n){if(t>=d.freeze[1]&&!S[1]++&&v.line([e,0],[e,y]).clipRect(e,0,h,y),t>=c)e+=i;else if(t>=d.freeze[1])return;O.sci<=t&&t<=O.eci&&Wn.call(l,e,0,n,r),v.fillText(p(t),e+n/2,r/2),t>0&&d.cols.isHide(t-1)&&(v.save(),v.attr({strokeStyle:"#c6c6c6"}),v.line([e+5,5],[e+5,r-5]),v.restore()),v.line([e,0],[e,y-a]),t===s&&v.line([e+n,0],[e+n,y])})),v.restore()}function $n(t,e,r,n){var o=this.draw,i=this.data,a=i.viewWidth()-t,l=i.viewHeight()-e;o.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),o.line([0,n],[a,n]),o.line([r,0],[r,l]),o.restore()}var qn=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new nn(e,r.viewWidth(),r.viewHeight()),this.data=r},(e=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,r=t.cols.indexWidth,n=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var o=t.viewRange();o.sri--,o.sci--;var i=t.freezeTotalWidth(),a=t.freezeTotalHeight(),l=t.scroll,u=l.x,c=l.y;Un.call(this,o,r,n,i,a,-u,-c),Fn.call(this,o,r,n,i,a,-u,-c),Vn.call(this,r,n);var f=Rn(t.freeze,2),s=f[0],h=f[1];if(s>0||h>0){if(s>0){var y=o.clone();y.sri=0,y.eri=s-1,y.h=a,Fn.call(this,y,r,n,i,0,-u,0)}if(h>0){var p=o.clone();p.sci=0,p.eci=h-1,p.w=i,Fn.call(this,p,r,n,0,a,0,-c)}var v=t.freezeViewRange();Fn.call(this,v,r,n,0,0,0,0),$n.call(this,r,n,i,a)}}},{key:"clear",value:function(){this.draw.clear()}}])&&Dn(t.prototype,e),r&&Dn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jn(t){return function(t){if(Array.isArray(t))return Xn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Xn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Yn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zn(n.key),n)}}function Zn(t){var e=function(t,e){if("object"!=Ln(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ln(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ln(e)?e:e+""}var Kn=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],Gn=["landscape","portrait"];function Qn(t){return parseInt(96*t,10)}function to(t){"cancel"===t?this.el.hide():this.toPrint()}function eo(t){var e=this.paper,r=t.target.value,n=Kn[r];e.w=Qn(n[1]),e.h=Qn(n[2]),this.preview()}function ro(t){var e=this.paper,r=t.target.value,n=Gn[r];e.orientation=n,this.preview()}var no=function(){return t=function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:Qn(Kn[0][1]),h:Qn(Kn[0][2]),padding:50,orientation:Gn[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=f("div","".concat(pe,"-print")).children(f("div","".concat(pe,"-print-bar")).children(f("div","-title").child("Print settings"),f("div","-right").children(f("div","".concat(pe,"-buttons")).children(new Wr("cancel").on("click",to.bind(this,"cancel")),new Wr("next","primary").on("click",to.bind(this,"next"))))),f("div","".concat(pe,"-print-content")).children(this.contentEl=f("div","-content"),f("div","-sider").child(f("form","").children(f("fieldset","").children(f("label","").child("".concat(jt("print.size"))),(r=f("select","")).children.apply(r,Jn(Kn.map((function(t,e){return f("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",eo.bind(this))),f("fieldset","").children(f("label","").child("".concat(jt("print.orientation"))),(n=f("select","")).children.apply(n,Jn(Gn.map((function(t,e){return f("option","").attr("value",e).child("".concat(jt("print.orientations")[e]))})))).on("change",ro.bind(this))))))).hide()},(e=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,r=this.paper,n=r.width,o=r.height,i=r.padding,a=n-2*i,l=o-2*i,u=e.contentRange(),c=parseInt(u.h/l,10)+1,s=a/u.w,h=i,y=i;s>1&&(h+=(a-u.w)/2);var p=0,v=0;this.contentEl.html(""),this.canvases=[];for(var d={sri:0,sci:0,eri:0,eci:0},b=function(){var r=0,i=0,a=f("div","".concat(pe,"-canvas-card")),c=f("canvas","".concat(pe,"-canvas"));t.canvases.push(c.el);var b=new nn(c.el,n,o);for(b.save(),b.translate(h,y),s<1&&b.scale(s,s);p<=u.eri;p+=1){var m=e.rows.getHeight(p);if(!((r+=m)<l)){i=-(r-m);break}for(var g=0;g<=u.eci;g+=1)Mn(b,e,p,g,v),d.eci=g}d.eri=p,b.restore(),b.save(),b.translate(h,y),s<1&&b.scale(s,s);var w=v;e.eachMergesInView(d,(function(t){var r=t.sri,n=t.sci;Mn(b,e,r,n,w)})),b.restore(),d.sri=d.eri,d.sci=d.eci,v+=i,t.contentEl.child(f("div","".concat(pe,"-canvas-card-wraper")).child(a.child(c)))},m=0;m<c;m+=1)b();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=f("iframe","").hide().el;window.document.body.appendChild(e);var r=e.contentWindow,n=r.document,o=document.createElement("style");o.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),n.head.appendChild(o),this.canvases.forEach((function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),n.body.appendChild(e)})),r.print()}}])&&Yn(t.prototype,e),r&&Yn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function oo(t){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function io(t){return function(t){if(Array.isArray(t))return ao(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ao(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ao(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function lo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,co(n.key),n)}}function co(t){var e=function(t,e){if("object"!=oo(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=oo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==oo(e)?e:e+""}var fo=[{key:"copy",title:kt("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:kt("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:kt("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:kt("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:kt("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:kt("contextmenu.insertRow")},{key:"insert-column",title:kt("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:kt("contextmenu.deleteRow")},{key:"delete-column",title:kt("contextmenu.deleteColumn")},{key:"delete-cell-text",title:kt("contextmenu.deleteCellText")},{key:"hide",title:kt("contextmenu.hide")},{key:"divider"},{key:"validation",title:kt("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:kt("contextmenu.cellprintable")},{key:"cell-non-printable",title:kt("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:kt("contextmenu.celleditable")},{key:"cell-non-editable",title:kt("contextmenu.cellnoneditable")}];function so(t){var e=this;return"divider"===t.key?f("div","".concat(pe,"-item divider")):f("div","".concat(pe,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),f("div","label").child(t.label||""))}function ho(){var t=this;return fo.map((function(e){return so.call(t,e)}))}var yo=function(){return t=function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];lo(this,t),this.menuItems=ho.call(this),this.el=(r=f("div","".concat(pe,"-contextmenu"))).children.apply(r,io(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=n,this.setMode("range")},(e=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),fe(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var r=this.el,n=r.show().offset().width,o=this.viewFn(),i=o.height/2,a=t;o.width-t<=n&&(a-=n),r.css("left","".concat(a,"px")),e>i?r.css("bottom","".concat(o.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):r.css("top","".concat(e,"px")).css("max-height","".concat(o.height-e,"px")).css("bottom","auto"),se(r)}}}])&&uo(t.prototype,e),r&&uo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function po(t){return(po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bo(n.key),n)}}function bo(t){var e=function(t,e){if("object"!=po(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=po(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==po(e)?e:e+""}var mo=function(){return t=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip="",e&&(this.tip=jt("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))))),r&&(this.tip+=" (".concat(r,")")),this.tag=e,this.shortcut=r,this.value=n,this.el=this.element(),this.change=function(){}},(e=[{key:"element",value:function(){var t=this,e=this.tip;return f("div","".concat(pe,"-toolbar-btn")).on("mouseenter",(function(e){t.tip&&function(t,e){if(!e.classList.contains("active")){var r=e.getBoundingClientRect(),n=r.left,o=r.top,i=r.width,a=r.height,l=f("div","".concat(pe,"-tooltip")).html(t).show();document.body.appendChild(l.el);var u=l.box();l.css("left","".concat(n+i/2-u.width/2,"px")).css("top","".concat(o+a+2,"px")),ue(e,"mouseleave",(function(){document.body.contains(l.el)&&document.body.removeChild(l.el)})),ue(e,"click",(function(){document.body.contains(l.el)&&document.body.removeChild(l.el)}))}}(t.tip,e.target)})).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&vo(t.prototype,e),r&&vo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function go(t){return(go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function So(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Oo(n.key),n)}}function Oo(t){var e=function(t,e){if("object"!=go(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=go(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==go(e)?e:e+""}function jo(t,e,r){return e=Eo(e),function(t,e){if(e&&("object"==go(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Eo(t).constructor):e.apply(t,r))}function ko(){return(ko="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=Po(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(null,arguments)}function Po(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Eo(t)););return t}function Eo(t){return(Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xo(t,e){return(xo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var To=function(t){function e(){return wo(this,e),jo(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xo(t,e)}(e,t),function(t,e,r){return e&&So(t.prototype,e),r&&So(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t,r,n,o,i,a=this,l=this.tag;return this.dd=this.dropdown(),this.dd.change=function(t){return a.change(l,a.getValue(t))},(t=e,r="element",n=this,o=3,i=ko(Eo(1&o?t.prototype:t),r,n),2&o?function(t){return i.apply(n,t)}:i)([]).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])}(mo);function Co(t){return(Co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ao(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ro(n.key),n)}}function Ro(t){var e=function(t,e){if("object"!=Co(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Co(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Co(e)?e:e+""}function Io(t,e,r){return e=Do(e),function(t,e){if(e&&("object"==Co(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Do(t).constructor):e.apply(t,r))}function Do(t){return(Do=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function No(t,e){return(No=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var zo=function(t){function e(t,r,n,o){var i,a;_o(this,e),(a=Io(this,e,["div","".concat(pe,"-dropdown ").concat(o)])).title=t,a.change=function(){},a.headerClick=function(){},"string"==typeof t?a.title=f("div","".concat(pe,"-dropdown-title")).child(t):n&&a.title.addClass("arrow-left"),a.contentEl=f("div","".concat(pe,"-dropdown-content")).css("width",r).hide();for(var l=arguments.length,u=new Array(l>4?l-4:0),c=4;c<l;c++)u[c-4]=arguments[c];return(i=a).setContentChildren.apply(i,u),a.headerEl=f("div","".concat(pe,"-dropdown-header")),a.headerEl.on("click",(function(){"block"!==a.contentEl.css("display")?a.show():a.hide()})).children(a.title,n?f("div","".concat(pe,"-icon arrow-right")).child(f("div","".concat(pe,"-icon-img arrow-down"))):""),a.children(a.headerEl,a.contentEl),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&No(t,e)}(e,t),r=e,(n=[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),arguments.length>0&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),se(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),fe(this.parent())}}])&&Ao(r.prototype,n),o&&Ao(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c);function Bo(t){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mo(t){return function(t){if(Array.isArray(t))return Ho(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ho(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ho(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ho(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Fo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wo(n.key),n)}}function Wo(t){var e=function(t,e){if("object"!=Bo(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Bo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Bo(e)?e:e+""}function Vo(t,e,r){return e=Uo(e),function(t,e){if(e&&("object"==Bo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Uo(t).constructor):e.apply(t,r))}function Uo(t){return(Uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $o(t,e){return($o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var qo=function(t){function e(t,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new or("align-".concat(r)),i=t.map((function(t){return(e="align-".concat(t),f("div","".concat(pe,"-item")).child(new or(e))).on("click",(function(){n.setTitle(t),n.change(t)}));var e}));return n=Vo(this,e,[o,"auto",!0,"bottom-left"].concat(Mo(i)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$o(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&Fo(r.prototype,n),o&&Fo(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(zo);function Lo(t){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xo(n.key),n)}}function Xo(t){var e=function(t,e){if("object"!=Lo(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Lo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Lo(e)?e:e+""}function Yo(t,e,r){return e=Zo(e),function(t,e){if(e&&("object"==Lo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Zo(t).constructor):e.apply(t,r))}function Zo(t){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ko(t,e){return(Ko=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Go=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Yo(this,e,["align","",t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ko(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.value;return new qo(["left","center","right"],t)}}])&&Jo(r.prototype,n),o&&Jo(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(To);function Qo(t){return(Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ti(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ei(n.key),n)}}function ei(t){var e=function(t,e){if("object"!=Qo(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Qo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Qo(e)?e:e+""}function ri(t,e,r){return e=ni(e),function(t,e){if(e&&("object"==Qo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],ni(t).constructor):e.apply(t,r))}function ni(t){return(ni=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oi(t,e){return(oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ii=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ri(this,e,["valign","",t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oi(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.value;return new qo(["top","middle","bottom"],t)}}])&&ti(r.prototype,n),o&&ti(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(To);function ai(t){return(ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function li(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ui(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ci(n.key),n)}}function ci(t){var e=function(t,e){if("object"!=ai(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ai(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ai(e)?e:e+""}function fi(t,e,r){return e=yi(e),function(t,e){if(e&&("object"==ai(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],yi(t).constructor):e.apply(t,r))}function si(){return(si="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=hi(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(null,arguments)}function hi(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=yi(t)););return t}function yi(t){return(yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pi(t,e){return(pi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var vi=function(t){function e(){return li(this,e),fi(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pi(t,e)}(e,t),function(t,e,r){return e&&ui(t.prototype,e),r&&ui(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"element",value:function(){var t,r,n,o,i,a=this,l=this.tag;return(t=e,r="element",n=this,o=3,i=si(yi(1&o?t.prototype:t),r,n),2&o?function(t){return i.apply(n,t)}:i)([]).child(new or(l)).on("click",(function(){return a.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])}(mo);function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mi(n.key),n)}}function mi(t){var e=function(t,e){if("object"!=di(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=di(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==di(e)?e:e+""}function gi(t,e,r){return e=wi(e),function(t,e){if(e&&("object"==di(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],wi(t).constructor):e.apply(t,r))}function wi(t){return(wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Si(t,e){return(Si=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Oi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),gi(this,e,["autofilter"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Si(t,e)}(e,t),r=e,(n=[{key:"setState",value:function(){}}])&&bi(r.prototype,n),o&&bi(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(vi);function ji(t){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ki(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pi(n.key),n)}}function Pi(t){var e=function(t,e){if("object"!=ji(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ji(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ji(e)?e:e+""}function Ei(t,e,r){return e=xi(e),function(t,e){if(e&&("object"==ji(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],xi(t).constructor):e.apply(t,r))}function xi(t){return(xi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ti(t,e){return(Ti=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ci=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ei(this,e,["font-bold","Ctrl+B"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ti(t,e)}(e,t),r=e,n&&ki(r.prototype,n),o&&ki(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(vi);function _i(t){return(_i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ai(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ri(n.key),n)}}function Ri(t){var e=function(t,e){if("object"!=_i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_i(e)?e:e+""}function Ii(t,e,r){return e=Di(e),function(t,e){if(e&&("object"==_i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Di(t).constructor):e.apply(t,r))}function Di(t){return(Di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ni(t,e){return(Ni=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var zi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ii(this,e,["font-italic","Ctrl+I"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ni(t,e)}(e,t),r=e,n&&Ai(r.prototype,n),o&&Ai(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(vi);function Bi(t){return(Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hi(n.key),n)}}function Hi(t){var e=function(t,e){if("object"!=Bi(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Bi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Bi(e)?e:e+""}function Fi(t,e,r){return e=Wi(e),function(t,e){if(e&&("object"==Bi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Wi(t).constructor):e.apply(t,r))}function Wi(t){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vi(t,e){return(Vi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ui=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Fi(this,e,["strike","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vi(t,e)}(e,t),r=e,n&&Mi(r.prototype,n),o&&Mi(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(vi);function $i(t){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Li(n.key),n)}}function Li(t){var e=function(t,e){if("object"!=$i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=$i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$i(e)?e:e+""}function Ji(t,e,r){return e=Xi(e),function(t,e){if(e&&("object"==$i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Xi(t).constructor):e.apply(t,r))}function Xi(t){return(Xi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yi(t,e){return(Yi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Zi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ji(this,e,["underline","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yi(t,e)}(e,t),r=e,n&&qi(r.prototype,n),o&&qi(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(vi);function Ki(t){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gi(t){return function(t){if(Array.isArray(t))return Qi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Qi(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qi(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qi(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ta(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ra(n.key),n)}}function ea(t,e,r){return e&&ta(t.prototype,e),r&&ta(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ra(t){var e=function(t,e){if("object"!=Ki(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ki(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ki(e)?e:e+""}var na=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],oa=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],ia=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function aa(t){var e=this;return f("td","").child(f("div","".concat(pe,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var la=ea((function t(){var e,r,n,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=f("div","".concat(pe,"-color-palette")),this.change=function(){};var i=f("table","").children((e=f("tbody","")).children.apply(e,[(r=f("tr","".concat(pe,"-theme-color-placeholders"))).children.apply(r,Gi(na.map((function(t){return aa.call(o,t)}))))].concat(Gi(oa.map((function(t){var e;return(e=f("tr","".concat(pe,"-theme-colors"))).children.apply(e,Gi(t.map((function(t){return aa.call(o,t)}))))}))),[(n=f("tr","".concat(pe,"-standard-colors"))).children.apply(n,Gi(ia.map((function(t){return aa.call(o,t)}))))])));this.el.child(i)}));function ua(t){return(ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ca(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fa(n.key),n)}}function fa(t){var e=function(t,e){if("object"!=ua(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ua(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ua(e)?e:e+""}function sa(t,e,r){return e=ha(e),function(t,e){if(e&&("object"==ua(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],ha(t).constructor):e.apply(t,r))}function ha(t){return(ha=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ya(t,e){return(ya=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var pa=function(t){function e(t,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new or(t).css("height","16px").css("border-bottom","3px solid ".concat(r)),i=new la;return i.change=function(t){n.setTitle(t),n.change(t)},n=sa(this,e,[o,"auto",!1,"bottom-left",i.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ya(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&ca(r.prototype,n),o&&ca(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(zo);function va(t){return(va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function da(t){return function(t){if(Array.isArray(t))return ba(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ba(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ba(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ba(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ma(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ga(n.key),n)}}function ga(t){var e=function(t,e){if("object"!=va(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=va(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==va(e)?e:e+""}function wa(t,e,r){return e=Sa(e),function(t,e){if(e&&("object"==va(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Sa(t).constructor):e.apply(t,r))}function Sa(t){return(Sa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oa(t,e){return(Oa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ja=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],ka=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new or("line-type"),o=0,i=ja.map((function(e,n){return f("div","".concat(pe,"-item state ").concat(t===e[0]?"checked":"")).on("click",(function(){i[o].toggle("checked"),i[n].toggle("checked"),o=n,r.hide(),r.change(e)})).child(f("div","".concat(pe,"-line-type")).html(e[1]))}));return r=wa(this,e,[n,"auto",!1,"bottom-left"].concat(da(i)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oa(t,e)}(e,t),r=e,n&&ma(r.prototype,n),o&&ma(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(zo);function Pa(t){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ea(t){return function(t){if(Array.isArray(t))return Ca(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ta(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||Ta(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ta(t,e){if(t){if("string"==typeof t)return Ca(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ca(t,e):void 0}}function Ca(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ra(n.key),n)}}function Aa(t,e,r){return e&&_a(t.prototype,e),r&&_a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ra(t){var e=function(t,e){if("object"!=Pa(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Pa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Pa(e)?e:e+""}function Ia(){var t;return f("table","").child((t=f("tbody","")).children.apply(t,arguments))}function Da(t){var e=this;return f("td","").child(f("div","".concat(pe,"-border-palette-cell")).child(new or("border-".concat(t))).on("click",(function(){e.mode=t;var r=e.mode,n=e.style,o=e.color;e.change({mode:r,style:n,color:o})})))}var Na=Aa((function t(){var e,r,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new pa("line-color",this.color),this.ddColor.change=function(t){n.color=t},this.ddType=new ka(this.style),this.ddType.change=function(t){var e=xa(t,1)[0];n.style=e},this.el=f("div","".concat(pe,"-border-palette"));var o=Ia(f("tr","").children(f("td","".concat(pe,"-border-palette-left")).child(Ia((e=f("tr","")).children.apply(e,Ea(["all","inside","horizontal","vertical","outside"].map((function(t){return Da.call(n,t)})))),(r=f("tr","")).children.apply(r,Ea(["left","top","right","bottom","none"].map((function(t){return Da.call(n,t)})))))),f("td","".concat(pe,"-border-palette-right")).children(f("div","".concat(pe,"-toolbar-btn")).child(this.ddColor.el),f("div","".concat(pe,"-toolbar-btn")).child(this.ddType.el))));this.el.child(o)}));function za(t){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ba(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ma(n.key),n)}}function Ma(t){var e=function(t,e){if("object"!=za(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=za(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==za(e)?e:e+""}function Ha(t,e,r){return e=Fa(e),function(t,e){if(e&&("object"==za(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Fa(t).constructor):e.apply(t,r))}function Fa(t){return(Fa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wa(t,e){return(Wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Va=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new or("border-all"),n=new Na;return n.change=function(e){t.change(e),t.hide()},t=Ha(this,e,[r,"auto",!1,"bottom-left",n.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wa(t,e)}(e,t),r=e,n&&Ba(r.prototype,n),o&&Ba(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(zo);function Ua(t){return(Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qa(n.key),n)}}function qa(t){var e=function(t,e){if("object"!=Ua(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ua(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ua(e)?e:e+""}function La(t,e,r){return e=Ja(e),function(t,e){if(e&&("object"==Ua(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Ja(t).constructor):e.apply(t,r))}function Ja(t){return(Ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xa(t,e){return(Xa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ya=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),La(this,e,["border"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xa(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){return new Va}}])&&$a(r.prototype,n),o&&$a(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(To);function Za(t){return(Za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ka(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ga(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qa(n.key),n)}}function Qa(t){var e=function(t,e){if("object"!=Za(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Za(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Za(e)?e:e+""}function tl(t,e,r){return e=nl(e),function(t,e){if(e&&("object"==Za(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],nl(t).constructor):e.apply(t,r))}function el(){return(el="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=rl(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(null,arguments)}function rl(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=nl(t)););return t}function nl(t){return(nl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ol(t,e){return(ol=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var il=function(t){function e(){return Ka(this,e),tl(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ol(t,e)}(e,t),function(t,e,r){return e&&Ga(t.prototype,e),r&&Ga(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"element",value:function(){var t,r,n,o,i,a=this;return(t=e,r="element",n=this,o=3,i=el(nl(1&o?t.prototype:t),r,n),2&o?function(t){return i.apply(n,t)}:i)([]).child(new or(this.tag)).on("click",(function(){return a.change(a.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}])}(mo);function al(t){return(al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ll(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ul(n.key),n)}}function ul(t){var e=function(t,e){if("object"!=al(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=al(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==al(e)?e:e+""}function cl(t,e,r){return e=fl(e),function(t,e){if(e&&("object"==al(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],fl(t).constructor):e.apply(t,r))}function fl(t){return(fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sl(t,e){return(sl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var hl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),cl(this,e,["clearformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sl(t,e)}(e,t),r=e,n&&ll(r.prototype,n),o&&ll(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(il);function yl(t){return(yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vl(n.key),n)}}function vl(t){var e=function(t,e){if("object"!=yl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=yl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yl(e)?e:e+""}function dl(t,e,r){return e=bl(e),function(t,e){if(e&&("object"==yl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],bl(t).constructor):e.apply(t,r))}function bl(t){return(bl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ml(t,e){return(ml=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var gl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),dl(this,e,["paintformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ml(t,e)}(e,t),r=e,(n=[{key:"setState",value:function(){}}])&&pl(r.prototype,n),o&&pl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(vi);function wl(t){return(wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ol(n.key),n)}}function Ol(t){var e=function(t,e){if("object"!=wl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=wl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wl(e)?e:e+""}function jl(t,e,r){return e=kl(e),function(t,e){if(e&&("object"==wl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],kl(t).constructor):e.apply(t,r))}function kl(t){return(kl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pl(t,e){return(Pl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var El=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),jl(this,e,["color",void 0,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pl(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new pa(t,e)}}])&&Sl(r.prototype,n),o&&Sl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(To);function xl(t){return(xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cl(n.key),n)}}function Cl(t){var e=function(t,e){if("object"!=xl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=xl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xl(e)?e:e+""}function _l(t,e,r){return e=Al(e),function(t,e){if(e&&("object"==xl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Al(t).constructor):e.apply(t,r))}function Al(t){return(Al=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rl(t,e){return(Rl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Il=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_l(this,e,["bgcolor",void 0,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rl(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new pa(t,e)}}])&&Tl(r.prototype,n),o&&Tl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(To);function Dl(t){return(Dl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nl(t){return function(t){if(Array.isArray(t))return zl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return zl(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zl(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zl(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Bl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ml(n.key),n)}}function Ml(t){var e=function(t,e){if("object"!=Dl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Dl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Dl(e)?e:e+""}function Hl(t,e,r){return e=Fl(e),function(t,e){if(e&&("object"==Dl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Fl(t).constructor):e.apply(t,r))}function Fl(t){return(Fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wl(t,e){return(Wl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Vl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=an.map((function(e){return f("div","".concat(pe,"-item")).on("click",(function(){t.setTitle("".concat(e.pt)),t.change(e)})).child("".concat(e.pt))}));return t=Hl(this,e,["10","60px",!0,"bottom-left"].concat(Nl(r)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wl(t,e)}(e,t),r=e,n&&Bl(r.prototype,n),o&&Bl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(zo);function Ul(t){return(Ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ql(n.key),n)}}function ql(t){var e=function(t,e){if("object"!=Ul(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ul(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ul(e)?e:e+""}function Ll(t,e,r){return e=Jl(e),function(t,e){if(e&&("object"==Ul(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Jl(t).constructor):e.apply(t,r))}function Jl(t){return(Jl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xl(t,e){return(Xl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Yl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ll(this,e,["font-size"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xl(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Vl}}])&&$l(r.prototype,n),o&&$l(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(To);function Zl(t){return(Zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kl(t){return function(t){if(Array.isArray(t))return Gl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Gl(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gl(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gl(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ql(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tu(n.key),n)}}function tu(t){var e=function(t,e){if("object"!=Zl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Zl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Zl(e)?e:e+""}function eu(t,e,r){return e=ru(e),function(t,e){if(e&&("object"==Zl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],ru(t).constructor):e.apply(t,r))}function ru(t){return(ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nu(t,e){return(nu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ou=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=on.map((function(e){return f("div","".concat(pe,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=eu(this,e,[on[0].title,"160px",!0,"bottom-left"].concat(Kl(r)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nu(t,e)}(e,t),r=e,n&&Ql(r.prototype,n),o&&Ql(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(zo);function iu(t){return(iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function au(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lu(n.key),n)}}function lu(t){var e=function(t,e){if("object"!=iu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=iu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==iu(e)?e:e+""}function uu(t,e,r){return e=cu(e),function(t,e){if(e&&("object"==iu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],cu(t).constructor):e.apply(t,r))}function cu(t){return(cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fu(t,e){return(fu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var su=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),uu(this,e,["font-name"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fu(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new ou}}])&&au(r.prototype,n),o&&au(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(To);function hu(t){return(hu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yu(t){return function(t){if(Array.isArray(t))return pu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return pu(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pu(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function vu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,du(n.key),n)}}function du(t){var e=function(t,e){if("object"!=hu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=hu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==hu(e)?e:e+""}function bu(t,e,r){return e=mu(e),function(t,e){if(e&&("object"==hu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],mu(t).constructor):e.apply(t,r))}function mu(t){return(mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gu(t,e){return(gu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var wu=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Cn.slice(0);return r.splice(2,0,{key:"divider"}),r.splice(8,0,{key:"divider"}),r=r.map((function(e){var r=f("div","".concat(pe,"-item"));return"divider"===e.key?r.addClass("divider"):(r.child(e.title()).on("click",(function(){t.setTitle(e.title()),t.change(e)})),e.label&&r.child(f("div","label").html(e.label))),r})),t=bu(this,e,["Normal","220px",!0,"bottom-left"].concat(yu(r)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gu(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){for(var e=0;e<Cn.length;e+=1)Cn[e].key===t&&this.title.html(Cn[e].title());this.hide()}}])&&vu(r.prototype,n),o&&vu(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(zo);function Su(t){return(Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ou(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ju(n.key),n)}}function ju(t){var e=function(t,e){if("object"!=Su(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Su(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Su(e)?e:e+""}function ku(t,e,r){return e=Pu(e),function(t,e){if(e&&("object"==Su(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Pu(t).constructor):e.apply(t,r))}function Pu(t){return(Pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Eu(t,e){return(Eu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var xu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ku(this,e,["format"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Eu(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new wu}}])&&Ou(r.prototype,n),o&&Ou(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(To);function Tu(t){return(Tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cu(t){return function(t){if(Array.isArray(t))return _u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return _u(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Au(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ru(n.key),n)}}function Ru(t){var e=function(t,e){if("object"!=Tu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Tu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Tu(e)?e:e+""}function Iu(t,e,r){return e=Du(e),function(t,e){if(e&&("object"==Tu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Du(t).constructor):e.apply(t,r))}function Du(t){return(Du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nu(t,e){return(Nu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var zu=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=gn.map((function(e){return f("div","".concat(pe,"-item")).on("click",(function(){t.hide(),t.change(e)})).child(e.key)}));return t=Iu(this,e,[new or("formula"),"180px",!0,"bottom-left"].concat(Cu(r)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nu(t,e)}(e,t),r=e,n&&Au(r.prototype,n),o&&Au(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(zo);function Bu(t){return(Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hu(n.key),n)}}function Hu(t){var e=function(t,e){if("object"!=Bu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Bu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Bu(e)?e:e+""}function Fu(t,e,r){return e=Wu(e),function(t,e){if(e&&("object"==Bu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Wu(t).constructor):e.apply(t,r))}function Wu(t){return(Wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vu(t,e){return(Vu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Uu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Fu(this,e,["formula"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vu(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new zu}}])&&Mu(r.prototype,n),o&&Mu(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(To);function $u(t){return($u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lu(n.key),n)}}function Lu(t){var e=function(t,e){if("object"!=$u(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=$u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$u(e)?e:e+""}function Ju(t,e,r){return e=Xu(e),function(t,e){if(e&&("object"==$u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Xu(t).constructor):e.apply(t,r))}function Xu(t){return(Xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yu(t,e){return(Yu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Zu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ju(this,e,["freeze"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yu(t,e)}(e,t),r=e,n&&qu(r.prototype,n),o&&qu(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(vi);function Ku(t){return(Ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qu(n.key),n)}}function Qu(t){var e=function(t,e){if("object"!=Ku(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ku(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ku(e)?e:e+""}function tc(t,e,r){return e=ec(e),function(t,e){if(e&&("object"==Ku(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],ec(t).constructor):e.apply(t,r))}function ec(t){return(ec=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rc(t,e){return(rc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var nc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),tc(this,e,["merge"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rc(t,e)}(e,t),r=e,(n=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&Gu(r.prototype,n),o&&Gu(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(vi);function oc(t){return(oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ic(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ac(n.key),n)}}function ac(t){var e=function(t,e){if("object"!=oc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=oc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==oc(e)?e:e+""}function lc(t,e,r){return e=uc(e),function(t,e){if(e&&("object"==oc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],uc(t).constructor):e.apply(t,r))}function uc(t){return(uc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cc(t,e){return(cc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var fc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),lc(this,e,["redo","Ctrl+Y"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cc(t,e)}(e,t),r=e,n&&ic(r.prototype,n),o&&ic(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(il);function sc(t){return(sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yc(n.key),n)}}function yc(t){var e=function(t,e){if("object"!=sc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=sc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==sc(e)?e:e+""}function pc(t,e,r){return e=vc(e),function(t,e){if(e&&("object"==sc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],vc(t).constructor):e.apply(t,r))}function vc(t){return(vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dc(t,e){return(dc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var bc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),pc(this,e,["undo","Ctrl+Z"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dc(t,e)}(e,t),r=e,n&&hc(r.prototype,n),o&&hc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(il);function mc(t){return(mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wc(n.key),n)}}function wc(t){var e=function(t,e){if("object"!=mc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=mc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==mc(e)?e:e+""}function Sc(t,e,r){return e=Oc(e),function(t,e){if(e&&("object"==mc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Oc(t).constructor):e.apply(t,r))}function Oc(t){return(Oc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jc(t,e){return(jc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var kc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Sc(this,e,["print","Ctrl+P"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jc(t,e)}(e,t),r=e,n&&gc(r.prototype,n),o&&gc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(il);function Pc(t){return(Pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ec(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xc(n.key),n)}}function xc(t){var e=function(t,e){if("object"!=Pc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Pc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Pc(e)?e:e+""}function Tc(t,e,r){return e=Cc(e),function(t,e){if(e&&("object"==Pc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Cc(t).constructor):e.apply(t,r))}function Cc(t){return(Cc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _c(t,e){return(_c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ac=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tc(this,e,["textwrap"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_c(t,e)}(e,t),r=e,n&&Ec(r.prototype,n),o&&Ec(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(vi);function Rc(t){return(Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ic(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nc(n.key),n)}}function Dc(t,e,r){return e&&Ic(t.prototype,e),r&&Ic(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nc(t){var e=function(t,e){if("object"!=Rc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Rc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Rc(e)?e:e+""}function zc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bc(t,e,r){return e=Mc(e),function(t,e){if(e&&("object"==Rc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Mc(t).constructor):e.apply(t,r))}function Mc(t){return(Mc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fc(t,e)}function Fc(t,e){return(Fc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Wc=function(t){function e(){var t;zc(this,e);var r=new or("ellipsis"),n=f("div","".concat(pe,"-toolbar-more"));return(t=Bc(this,e,[r,"auto",!1,"bottom-right",n])).moreBtns=n,t.contentEl.css("max-width","420px"),t}return Hc(e,t),Dc(e)}(zo),Vc=function(t){function e(){var t;return zc(this,e),(t=Bc(this,e,["more"])).el.hide(),t}return Hc(e,t),Dc(e,[{key:"dropdown",value:function(){return new Wc}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])}(To);function Uc(t){return(Uc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qc(n.key),n)}}function qc(t){var e=function(t,e){if("object"!=Uc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Uc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Uc(e)?e:e+""}function Lc(t,e,r){return e=Jc(e),function(t,e){if(e&&("object"==Uc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Jc(t).constructor):e.apply(t,r))}function Jc(t){return(Jc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xc(t,e){return(Xc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Yc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Lc(this,e,["jumpToCell"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xc(t,e)}(e,t),r=e,n&&$c(r.prototype,n),o&&$c(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(il);function Zc(t){return(Zc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qc(n.key),n)}}function Qc(t){var e=function(t,e){if("object"!=Zc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Zc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Zc(e)?e:e+""}function tf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ef(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ef(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ef(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function rf(){return f("div","".concat(pe,"-toolbar-divider"))}function nf(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var r=e.el,n=r.box(),o=r.computedStyle(),i=o.marginLeft,a=o.marginRight;t.btns2.push([r,n.width+parseInt(i,10)+parseInt(a,10)])}));else{var r=e.box(),n=e.computedStyle(),o=n.marginLeft,i=n.marginRight;t.btns2.push([e,r.width+parseInt(o,10)+parseInt(i,10)])}}))}function of(){var t,e,r=this.el,n=this.btns,o=this.moreEl,i=this.btns2,a=o.dd,l=a.moreBtns,u=a.contentEl;r.css("width","".concat(this.widthFn()-60,"px"));var c=r.box(),f=160,s=12,h=[],y=[];i.forEach((function(t,e){var r=tf(t,2),n=r[0],o=r[1];f+=o,e>=i.length-3||f<c.width?h.push(n):(s+=o,y.push(n))})),(t=n.html("")).children.apply(t,h),(e=l.html("")).children.apply(e,y),u.css("width","".concat(s,"px")),y.length>0?o.show():o.hide()}function af(t){var e=this,r=new mo;r.el.on("click",(function(){t.onClick&&t.onClick(e.data.getData(),e.data)})),r.tip=t.tip||"";var n=t.el;if(t.icon&&(n=f("img").attr("src",t.icon)),n){var o=f("div","".concat(pe,"-icon"));o.child(n),r.el.child(o)}return r}var lf=function(){return t=function t(e,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Kc(this,t),this.data=e,this.change=function(){},this.widthFn=r,this.isHide=o;var i=e.defaultStyle();this.items=[[this.undoEl=new bc,this.redoEl=new fc,new kc,this.paintformatEl=new gl,this.clearformatEl=new hl],rf(),[this.formatEl=new xu],rf(),[this.fontEl=new su,this.fontSizeEl=new Yl],rf(),[this.boldEl=new Ci,this.italicEl=new zi,this.underlineEl=new Zi,this.strikeEl=new Ui,this.textColorEl=new El(i.color)],rf(),[this.fillColorEl=new Il(i.bgcolor),this.borderEl=new Ya,this.mergeEl=new nc],rf(),[this.alignEl=new Go(i.align),this.valignEl=new ii(i.valign),this.textwrapEl=new Ac],rf(),[this.freezeEl=new Zu,this.autofilterEl=new Oi,this.formulaEl=new Uu,this.moreEl=new Vc],rf(),[this.jumpToCellEl=new Yc]];var a=e.settings.extendToolbar,l=void 0===a?{}:a;if(l.left&&l.left.length>0){this.items.unshift(rf());var u=l.left.map(af.bind(this));this.items.unshift(u)}if(l.right&&l.right.length>0){this.items.push(rf());var c=l.right.map(af.bind(this));this.items.push(c)}this.items.push([this.moreEl=new Vc]),this.el=f("div","".concat(pe,"-toolbar")),this.btns=f("div","".concat(pe,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){n.btns.child(t.el),t.change=function(){n.change.apply(n,arguments)}})):n.btns.child(t.el)})),this.el.child(this.btns),o?this.el.hide():(this.reset(),setTimeout((function(){nf.call(n),of.call(n)}),0),ue(window,"resize",(function(){of.call(n)})))},(e=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var r=e.font,n=e.format;this.formatEl.setState(n),this.fontEl.setState(r.name),this.fontSizeEl.setState(r.size),this.boldEl.setState(r.bold),this.italicEl.setState(r.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&Gc(t.prototype,e),r&&Gc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function uf(t){return(uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cf(t){return function(t){if(Array.isArray(t))return ff(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ff(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ff(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ff(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function sf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yf(n.key),n)}}function yf(t){var e=function(t,e){if("object"!=uf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=uf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==uf(e)?e:e+""}var pf=function(){return t=function t(e,r){var n,o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";sf(this,t),this.title=e,this.el=f("div","".concat(pe,"-modal")).css("width",i).children(f("div","".concat(pe,"-modal-header")).children(new or("close").on("click.stop",(function(){return o.hide()})),this.title),(n=f("div","".concat(pe,"-modal-content"))).children.apply(n,cf(r))).hide()},(e=[{key:"show",value:function(){var t=this;this.dimmer=f("div","".concat(pe,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),r=e.width,n=e.height,o=document.documentElement,i=o.clientHeight,a=o.clientWidth;this.el.offset({left:(a-r)/2,top:(i-n)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},ue(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),ce(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&hf(t.prototype,e),r&&hf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function vf(t){return(vf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function df(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bf(n.key),n)}}function bf(t){var e=function(t,e){if("object"!=vf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=vf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==vf(e)?e:e+""}var mf=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=f("div","".concat(pe,"-form-input")),this.input=f("input","").css("width",e).on("input",(function(t){return n.vchange(t)})).attr("placeholder",r),this.el.child(this.input)},(e=[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&df(t.prototype,e),r&&df(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function gf(t){return(gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Of(n.key),n)}}function Of(t){var e=function(t,e){if("object"!=gf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=gf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==gf(e)?e:e+""}var jf=function(){return t=function t(e,r,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};wf(this,t),this.key=e,this.getTitle=i,this.vchange=function(){},this.el=f("div","".concat(pe,"-form-select")),this.suggest=new Ke(r.map((function(t){return{key:t,title:o.getTitle(t)}})),(function(t){o.itemClick(t.key),a(t.key),o.vchange(t.key)}),n,this.el),this.el.children(this.itemEl=f("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(function(){this.show()}))},(e=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&Sf(t.prototype,e),r&&Sf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function kf(t){return(kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ef(n.key),n)}}function Ef(t){var e=function(t,e){if("object"!=kf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=kf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==kf(e)?e:e+""}var xf={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},Tf=function(){return t=function t(e,r,n,o){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=r,n&&(this.label=f("label","label").css("width","".concat(o,"px")).html(n)),this.tip=f("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return i.validate()},this.el=f("div","".concat(pe,"-form-field")).children(this.label,e.el,this.tip)},(e=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,r=this.tip,n=this.el,o=t.val();return e.required&&/^\s*$/.test(o)?(r.html(jt("validation.required")),n.addClass("error"),!1):!e.type&&!e.pattern||(e.pattern||xf[e.type]).test(o)?(n.removeClass("error"),!0):(r.html(jt("validation.notMatch")),n.addClass("error"),!1)}}])&&Pf(t.prototype,e),r&&Pf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Cf(t){return(Cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Af(n.key),n)}}function Af(t){var e=function(t,e){if("object"!=Cf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Cf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Cf(e)?e:e+""}function Rf(t,e,r){return e=If(e),function(t,e){if(e&&("object"==Cf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],If(t).constructor):e.apply(t,r))}function If(t){return(If=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Df(t,e){return(Df=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Nf=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new Tf(new jf("cell",["cell"],"100%",(function(t){return jt("dataValidation.modeType.".concat(t))})),{required:!0},"".concat(jt("dataValidation.range"),":"),100),n=new Tf(new mf("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),o=new Tf(new jf("list",["list","number","date","phone","email"],"100%",(function(t){return jt("dataValidation.type.".concat(t))}),(function(e){return t.criteriaSelected(e)})),{required:!0},"".concat(jt("dataValidation.criteria"),":"),100),i=new Tf(new jf("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(t){return jt("dataValidation.operator.".concat(t))}),(function(e){return t.criteriaOperatorSelected(e)})),{required:!0}).hide(),a=new Tf(new mf("70px","10"),{required:!0}).hide(),l=new Tf(new mf("70px","100"),{required:!0,type:"number"}).hide(),u=new Tf(new mf("120px","a,b,c"),{required:!0}),c=new Tf(new mf("70px","10"),{required:!0,type:"number"}).hide();return(t=Rf(this,e,[jt("contextmenu.validation"),[f("div","".concat(pe,"-form-fields")).children(r.el,n.el),f("div","".concat(pe,"-form-fields")).children(o.el,i.el,a.el,l.el,c.el,u.el),f("div","".concat(pe,"-buttons")).children(new Wr("cancel").on("click",(function(){return t.btnClick("cancel")})),new Wr("remove").on("click",(function(){return t.btnClick("remove")})),new Wr("save","primary").on("click",(function(){return t.btnClick("save")})))]])).mf=r,t.rf=n,t.cf=o,t.of=i,t.minvf=a,t.maxvf=l,t.vf=c,t.svf=u,t.change=function(){},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Df(t,e)}(e,t),r=e,(n=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",r=this.vf;r.input.hint(e),r.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,r=this.minvf,n=this.maxvf,o=this.vf,i=this.svf;"date"===t||"number"===t?(e.show(),r.rule.type=t,n.rule.type=t,"date"===t?(r.hint("2018-11-12"),n.hint("2019-11-12")):(r.hint("10"),n.hint("100")),r.show(),n.show(),o.hide(),i.hide()):("list"===t?i.show():i.hide(),o.hide(),e.hide(),r.hide(),n.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,r=this.maxvf,n=this.vf;if("be"===t||"nbe"===t)e.show(),r.show(),n.hide();else{var o=this.cf.val();n.rule.type=o,"date"===o?n.hint("2018-11-12"):n.hint("10"),n.show(),e.hide(),r.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],r=0;r<e.length;r+=1){var n=this[e[r]];if(n.isShow()&&!n.validate())return}var o=this.mf.val(),i=this.rf.val(),a=this.cf.val(),l=this.of.val(),u=this.svf.val();"number"!==a&&"date"!==a||(u="be"===l||"nbe"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",o,i,{type:a,operator:l,required:!1,value:u}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,r=this.rf,n=this.cf,o=this.of,i=this.svf,a=this.vf,l=this.minvf,u=this.maxvf,c=t.mode,f=t.ref,s=t.validator||{type:"list"},h=s.type,y=s.operator,p=s.value;e.val(c||"cell"),r.val(f),n.val(h),o.val(y),Array.isArray(p)?(l.val(p[0]),u.val(p[1])):(i.val(p||""),a.val(p||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(y)}this.show()}}])&&_f(r.prototype,n),o&&_f(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(pf);function zf(t){return(zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mf(n.key),n)}}function Mf(t){var e=function(t,e){if("object"!=zf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=zf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==zf(e)?e:e+""}function Hf(t,e,r){return e=Ff(e),function(t,e){if(e&&("object"==zf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Ff(t).constructor):e.apply(t,r))}function Ff(t){return(Ff=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wf(t,e){return(Wf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Vf=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new Tf(new mf("70px","10"),{required:!0});return(t=Hf(this,e,["Jump to row",[f("div","".concat(pe,"-form-fields")).children(r.el),f("div","".concat(pe,"-buttons")).children(new Wr("ok","primary").on("click",(function(){return t.btnClick("ok")})))],100])).ff=r,t.change=function(){},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wf(t,e)}(e,t),r=e,(n=[{key:"btnClick",value:function(t){"ok"===t&&(this.change(this.ff.val()),this.hide())}},{key:"showTo",value:function(){this.show()}}])&&Bf(r.prototype,n),o&&Bf(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(pf);function Uf(t){return(Uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qf(n.key),n)}}function qf(t){var e=function(t,e){if("object"!=Uf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Uf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Uf(e)?e:e+""}function Lf(t){return f("div","".concat(pe,"-item ").concat(t))}function Jf(t){var e=this;return Lf("state").child(jt("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function Xf(t){var e=this,r=this.filterbEl,n=this.filterValues;r.html(""),Object.keys(t).forEach((function(o,i){var a=t[o],l=n.includes(o)?"checked":"";r.child(f("div","".concat(pe,"-item state ").concat(l)).on("click.stop",(function(){return e.filterClick(i,o)})).children(""===o?jt("filter.empty"):o,f("div","label").html("(".concat(a,")"))))}))}function Yf(){var t=this.filterhEl,e=this.filterValues,r=this.values;t.html("".concat(e.length," / ").concat(r.length)),t.checked(e.length===r.length)}var Zf=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=f("div","".concat(pe,"-body")),this.filterhEl=f("div","".concat(pe,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=f("div","".concat(pe,"-sort-filter")).children(this.sortAscEl=Jf.call(this,"asc"),this.sortDescEl=Jf.call(this,"desc"),Lf("divider"),f("div","".concat(pe,"-filter")).children(this.filterhEl,this.filterbEl),f("div","".concat(pe,"-buttons")).children(new Wr("cancel").on("click",(function(){return e.btnClick("cancel")})),new Wr("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]},(e=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,r=this.sort,n=this.filterValues;this.ok&&this.ok(e,r,"in",n)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,r=this.sortDescEl;e.checked("asc"===t),r.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var r=this.filterbEl,n=this.filterValues,o=this.values,i=r.children();"all"===e?i.length===n.length?(this.filterValues=[],i.forEach((function(t){return f(t).checked(!1)}))):(this.filterValues=Array.from(o),i.forEach((function(t){return f(t).checked(!0)}))):f(i[t]).toggle("checked")?n.push(e):n.splice(n.findIndex((function(t){return t===e})),1),Yf.call(this)}},{key:"set",value:function(t,e,r,n){this.ci=t;var o=this.sortAscEl,i=this.sortDescEl;null!==n?(this.sort=n.order,o.checked(n.asc()),i.checked(n.desc())):(this.sortDesc=null,o.checked(!1),i.checked(!1)),this.values=Object.keys(e),this.filterValues=r?Array.from(r.value):Object.keys(e),Xf.call(this,e,r),Yf.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var r=1;se(this.el,(function(){r<=0&&e.hide(),r-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),fe(this.el)}}])&&$f(t.prototype,e),r&&$f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Kf(t,e){var r=f("div","".concat(pe,"-toast")),n=f("div","".concat(pe,"-dimmer active"));r.children(f("div","".concat(pe,"-toast-header")).children(new or("close").on("click.stop",(function(){return document.body.removeChild(r.el),void document.body.removeChild(n.el)})),t),f("div","".concat(pe,"-toast-content")).html(e)),document.body.appendChild(r.el),document.body.appendChild(n.el);var o=r.box(),i=o.width,a=o.height,l=document.documentElement,u=l.clientHeight,c=l.clientWidth;r.offset({left:(c-i)/2,top:(u-a)/3})}function Gf(t){return(Gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ts(n.key),n)}}function ts(t){var e=function(t,e){if("object"!=Gf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Gf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gf(e)?e:e+""}function es(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return rs(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rs(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rs(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ns(){var t=this.data,e=this.verticalScrollbar,r=this.horizontalScrollbar,n=t.getSelectedRect(),o=n.l,i=n.t,a=n.left,l=n.top,u=n.width,c=n.height,f=this.getTableOffset();if(Math.abs(a)+u>f.width)r.scroll({left:o+u-f.width});else{var s=t.freezeTotalWidth();a<s&&r.scroll({left:o-1-s})}if(Math.abs(l)+c>f.height)e.scroll({top:i+c-f.height-1});else{var h=t.freezeTotalHeight();l<h&&e.scroll({top:i-1-h})}}function os(t,e,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(-1!==e||-1!==r){var i=this.table,a=this.selector,l=this.toolbar,u=this.data,c=this.contextMenu,f=u.getCell(e,r);t?(a.setEnd(e,r,o),this.trigger("cells-selected",f,a.range)):(a.set(e,r,n),this.trigger("cell-selected",f,e,r)),c.setMode(-1===e||-1===r?"row-col":"range"),l.reset(),i.render()}}function is(t,e){var r=this.selector,n=this.data,o=n.rows,i=n.cols,a=es(r.indexes,2),l=a[0],u=a[1],c=r.range,f=c.eri,s=c.eci;if(t){var h=es(r.moveIndexes,2);l=h[0],u=h[1]}"left"===e?u>0&&(u-=1):"right"===e?(s!==u&&(u=s),u<i.len-1&&(u+=1)):"up"===e?l>0&&(l-=1):"down"===e?(f!==l&&(l=f),l<o.len-1&&(l+=1)):"row-first"===e?u=0:"row-last"===e?u=i.len-1:"col-first"===e?l=0:"col-last"===e&&(l=o.len-1),t&&(r.moveIndexes=[l,u]),os.call(this,t,l,u),ns.call(this)}function as(t){if(0===t.buttons&&t.target.className!=="".concat(pe,"-resizer-hover")){var e=t.offsetX,r=t.offsetY,n=this.rowResizer,o=this.colResizer,i=this.tableEl,a=this.data,l=a.rows,u=a.cols;if(e>u.indexWidth&&r>l.height)return n.hide(),void o.hide();var c=i.box(),f=a.getCellRectByXY(t.offsetX,t.offsetY);f.ri>=0&&-1===f.ci?(f.width=u.indexWidth,n.show(f,{width:c.width}),l.isHide(f.ri-1)?n.showUnhide(f.ri):n.hideUnhide()):n.hide(),-1===f.ri&&f.ci>=0?(f.height=l.height,o.show(f,{height:c.height}),u.isHide(f.ci-1)?o.showUnhide(f.ci):o.hideUnhide()):o.hide()}}function ls(){var t=this.data,e=this.overlayerEl,r=this.overlayerEl.el,n=t.cols.totalWidth(),o=t.rows.totalHeight(),i=n+t.cols.indexWidth,a=o+t.rows.height;e.css({"--w":i,"--h":a},"px"),this.overlayerCEl.css({right:r.offsetWidth-r.clientWidth,bottom:r.offsetHeight-r.clientHeight},"px"),t.contSize={width:n,height:o}}function us(){var t=this.selector,e=this.data,r=this.editor,n=es(e.freeze,2),o=n[0],i=n[1];if(o>0||i>0){var a=e.freezeTotalWidth(),l=e.freezeTotalHeight();r.setFreezeLengths(a,l)}t.resetAreaOffset()}function cs(){var t=this.tableEl,e=this.overlayerEl,r=this.overlayerCEl,n=this.table,o=this.toolbar,i=this.selector,a=this.el,l=this.getTableOffset(),u=l.left,c=l.top,f=this.getRect();t.attr(f),e.offset(f),r.css({left:u,top:c},"px"),a.css("width","".concat(f.width,"px")),ls.call(this),us.call(this),o.reset(),i.reset(),n.render()}function fs(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function ss(t){var e=this.data,r=this.selector;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),r.showClipboard())}function hs(){var t=this.data,e=this.selector;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function ys(t,e){var r=this,n=this.data;if("read"!==n.settings.mode)if(n.clipboard.isClear()){n.pasteFromSystemClipboard((function(){return cs.call(r)}),(function(t){r.trigger("pasted-clipboard",t)}))}else if(n.paste(t,(function(t){return Kf("Tip",t)})))cs.call(this);else if(e){var o=e.clipboardData.getData("text/plain");this.data.pasteFromText(o),cs.call(this)}}function ps(){this.data.hideRowsOrCols(),cs.call(this)}function vs(t,e){this.data.unhideRowsOrCols(t,e),cs.call(this)}function ds(){this.data.autofilter(),cs.call(this)}function bs(){var t=this.toolbar;t.paintformatActive()&&(ys.call(this,"format"),fs.call(this),t.paintformatToggle())}function ms(t){var e=this,r=this.selector,n=this.data,o=this.table,i=this.sortFilter,a=t.offsetX,l=t.offsetY,u=t.target.className==="".concat(pe,"-selector-corner"),c=n.getCellRectByXY(a,l),f=c.left,s=c.top,h=c.width,y=c.height,p=c.ri,v=c.ci,d=n.autoFilter;if(d.includes(p,v)&&f+h-20<a&&s+y-20<l){var b=d.items(v,(function(t,e){return n.rows.getCell(t,e)}));return i.hide(),i.set(v,b,d.getFilter(v),d.getSort(v)),void i.setOffset({left:f,top:s+y+2})}t.shiftKey||(u?r.showAutofill(p,v):os.call(this,!1,p,v),he(window,(function(t){var o=n.getCellRectByXY(t.offsetX,t.offsetY);p=o.ri,v=o.ci,u?r.showAutofill(p,v):1!==t.buttons||t.shiftKey||os.call(e,!0,p,v,!0,!0)}),(function(){u&&r.arange&&"read"!==n.settings.mode&&n.autofill(r.arange,"all",(function(t){return Kf("Tip",t)}))&&o.render(),r.hideAutofill(),bs.call(e)}))),u||1!==t.buttons||t.shiftKey&&os.call(this,!0,p,v)}function gs(){var t=this.editor,e=this.data.getSelectedRect(),r=this.getTableOffset(),n="top";e.top>r.height/2&&(n="bottom"),t.setOffset(e,n)}function ws(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(gs.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),fs.call(this))}function Ss(t,e){var r=t.overlayerEl,n=t.data,o=t.table,i=t.selector;n.scrollx(r.el.scrollLeft,(function(){return e=1})),n.scrolly(r.el.scrollTop,(function(){return e=1})),e&&(i.resetBRLAreaOffset(),i.resetBRTAreaOffset(),gs.call(t),o.render())}function Os(t,e){var r=t.ri,n=this.table,o=this.selector;this.data.rows.setHeight(r,e),n.render(),o.resetAreaOffset(),ls.call(this),gs.call(this)}function js(t,e){var r=t.ci,n=this.table,o=this.selector;this.data.cols.setWidth(r,e),n.render(),o.resetAreaOffset(),ls.call(this),gs.call(this)}function ks(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",r=this.data,n=this.table;if("read"!==r.settings.mode){r.setSelectedCellText(t,e);var o=r.selector,i=o.ri,a=o.ci;"finished"===e&&(this.trigger("cell-edit-finished",t,i,a),n.render()),this.trigger("cell-edited",t,i,a)}}function Ps(t){var e=this.data;if("read"!==e.settings.mode){var r=e.selector,n=r.ri,o=r.ci;this.trigger(t,n,o),"insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t||("cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1)),fs.call(this),cs.call(this)}}function Es(t,e){var r=this.data;if(window.dispatchEvent(new CustomEvent("XSToolbarEvent",{detail:{type:t,value:e}})),"undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?ss.call(this):fs.call(this);else if("clearformat"===t)Ps.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)ds.call(this);else if("freeze"===t)if(e){var n=r.selector,o=n.ri,i=n.ci;this.freeze(o,i)}else this.freeze(0,0);else"jumpToCell"==t?this.modalJumpTo.showTo():(r.setSelectedCellAttr(t,e),"formula"!==t||r.selector.multiple()||ws.call(this),cs.call(this))}function xs(t,e,r,n){this.data.setAutoFilter(t,e,r,n),cs.call(this)}function Ts(){var t=this,e=this.selector,r=this.overlayerEl,n=this.rowResizer,o=this.colResizer,i=(this.verticalScrollbar,this.horizontalScrollbar,this.editor),a=this.contextMenu,l=this.toolbar,u=this.modalValidation,c=this.sortFilter,f=this.modalJumpTo;r.on("mousemove",(function(e){as.call(t,e)})).on("mousedown",(function(n){var o=n.offsetX,l=n.offsetY;if(!(o>r.el.clientWidth||l>r.el.clientHeight))if(i.clear(),a.hide(),2===n.buttons)t.data.xyInSelectedRect(o,l)||ms.call(t,n),a.setPosition(o,l),n.stopPropagation();else if(2===n.detail){var u=t.data.getSelectedCell(e.range.sri,e.range.eci);t.trigger("cell-dblclicked",u),u&&u.editable&&!1===u.editable?console.log("Editing Disabled"):ws.call(t)}else ms.call(t,n)})).on("mouseout",(function(t){var e=t.offsetX;t.offsetY<=0&&o.hide(),e<=0&&n.hide()})).on("scroll",(function(e){Ss(t)})),e.inputChange=function(e){ks.call(t,e,"input"),ws.call(t)},l.change=function(e,r){return Es.call(t,e,r)},c.ok=function(e,r,n,o){return xs.call(t,e,r,n,o)},n.finishedFn=function(e,r){Os.call(t,e,r)},o.finishedFn=function(e,r){js.call(t,e,r)},n.unhideFn=function(e){vs.call(t,"row",e)},o.unhideFn=function(e){vs.call(t,"col",e)},i.change=function(e,r){ks.call(t,r,e)},u.change=function(e){if("save"===e){for(var r,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(r=t.data).addValidation.apply(r,o)}else t.data.removeValidation()},f.change=function(e){(isNaN(e)||null==e||""==e)&&(e=1),os.call(t,!1,Number(e)-1,0),t.overlayerCEl.el.scrollTop=0,ns.call(t)},a.itemClick=function(e){"validation"===e?u.setValue(t.data.getSelectedValidation()):"copy"===e?ss.call(t):"cut"===e?hs.call(t):"paste"===e?ys.call(t,"all"):"paste-value"===e?ys.call(t,"text"):"paste-format"===e?ys.call(t,"format"):"hide"===e?ps.call(t):Ps.call(t,e)},ue(window,"resize",(function(){t.reload()})),ue(window,"click",(function(e){t.focusing=r.contains(e.target)})),ue(window,"paste",(function(e){t.focusing&&(ys.call(t,"all",e),t.trigger("pasted",e,t),e.preventDefault())})),ue(window,"copy",(function(e){t.focusing&&(ss.call(t,e),t.trigger("copied",e,t),e.preventDefault())})),ue(window,"keydown",(function(e){if(t.focusing){var r=e.keyCode||e.which,n=e.key,o=e.ctrlKey,u=e.shiftKey,c=e.metaKey;if(o||c)switch(r){case 90:t.undo(),e.preventDefault();break;case 89:t.redo(),e.preventDefault();break;case 67:ss.call(t),t.trigger("copied",e,t),e.preventDefault();break;case 88:hs.call(t),e.preventDefault();break;case 85:l.trigger("underline"),e.preventDefault();break;case 86:break;case 37:is.call(t,u,"row-first"),e.preventDefault();break;case 38:is.call(t,u,"col-first"),e.preventDefault();break;case 39:is.call(t,u,"row-last"),e.preventDefault();break;case 40:is.call(t,u,"col-last"),e.preventDefault();break;case 32:os.call(t,!1,-1,t.data.selector.ci,!1),e.preventDefault();break;case 66:l.trigger("bold");break;case 73:l.trigger("italic")}else{switch(r){case 32:u&&os.call(t,!1,t.data.selector.ri,-1,!1);break;case 27:a.hide(),fs.call(t);break;case 37:is.call(t,u,"left"),e.preventDefault();break;case 38:is.call(t,u,"up"),e.preventDefault();break;case 39:is.call(t,u,"right"),e.preventDefault();break;case 40:is.call(t,u,"down"),e.preventDefault();break;case 9:i.clear(),is.call(t,!1,u?"left":"right"),e.preventDefault();break;case 13:i.clear(),is.call(t,!1,u?"up":"down"),e.preventDefault();break;case 8:Ps.call(t,"delete-cell-text"),e.preventDefault()}"Delete"===n?(Ps.call(t,"delete-cell-text"),e.preventDefault()):r>=65&&r<=90||r>=48&&r<=57||r>=96&&r<=105||"="===e.key?(ks.call(t,e.key,"input"),ws.call(t)):113===r&&ws.call(t)}}}))}var Cs=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMap=ye();var o=r.settings,i=o.view,a=o.showToolbar,l=o.showContextmenu;this.el=f("div","".concat(pe,"-sheet")),this.toolbar=new lf(r,i.width,!a),this.print=new no(r),e.children(this.toolbar.el,this.el,this.print.el),this.data=r,this.tableEl=f("canvas","".concat(pe,"-table")),this.rowResizer=new ge(!1,r.rows.height),this.colResizer=new ge(!0,r.cols.minWidth),this.editor=new Ir(wn,(function(){return n.getTableOffset()}),r.rows.height),this.modalJumpTo=new Vf,this.modalValidation=new Nf,this.contextMenu=new yo((function(){return n.getRect()}),!l),this.selector=new Fe(r),this.overlayerCEl=f("div","".concat(pe,"-overlayer-content")).children(this.editor.el,this.selector.el),this.verticalScrollbar=this.horizontalScrollbar=this.overlayerEl=f("div","".concat(pe,"-overlayer")).child(this.overlayerCEl).child(this.contentEl=f("div","")),this.sortFilter=new Zf,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el,this.modalJumpTo.el),this.table=new qn(this.tableEl.el,r),Ts.call(this),cs.call(this),os.call(this,!1,0,0)},(e=[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"jump",value:function(t){os.call(this,!1,Number(t)-1,0),this.overlayerCEl.el.scrollTop=0,ns.call(this)}},{key:"trigger",value:function(t){for(var e=this.eventMap,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];e.fire(t,n)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,ls.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),cs.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),cs.call(this),Ss(this,!0),this}},{key:"undo",value:function(){this.data.undo(),cs.call(this)}},{key:"redo",value:function(){this.data.redo(),cs.call(this)}},{key:"reload",value:function(){return cs.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,r=t.cols,n=this.getRect(),o=n.width,i=n.height;return{width:o-r.indexWidth,height:i-e.height,left:r.indexWidth,top:e.height}}}])&&Qf(t.prototype,e),r&&Qf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function _s(t){return(_s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function As(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||Is(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rs(t){return function(t){if(Array.isArray(t))return Ds(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Is(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Is(t,e){if(t){if("string"==typeof t)return Ds(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ds(t,e):void 0}}function Ds(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ns(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ms(n.key),n)}}function Bs(t,e,r){return e&&zs(t.prototype,e),r&&zs(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ms(t){var e=function(t,e){if("object"!=_s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_s(e)?e:e+""}function Hs(t,e,r){return e=Fs(e),function(t,e){if(e&&("object"==_s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Fs(t).constructor):e.apply(t,r))}function Fs(t){return(Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ws(t,e){return(Ws=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Vs=function(t){function e(t){var r;return Ns(this,e),(r=Hs(this,e,[new or("ellipsis"),"auto",!1,"top-left"])).contentClick=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ws(t,e)}(e,t),Bs(e,[{key:"reset",value:function(t){var e=this,r=t.map((function(t,r){return f("div","".concat(pe,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(r),e.hide()})).child(t)}));this.setContentChildren.apply(this,Rs(r))}},{key:"setTitle",value:function(){}}])}(zo),Us=[{key:"delete",title:kt("contextmenu.deleteSheet")}];function $s(t){var e=this;return f("div","".concat(pe,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function qs(){var t=this;return Us.map((function(e){return $s.call(t,e)}))}var Ls=function(){return Bs((function t(){var e;Ns(this,t),this.el=(e=f("div","".concat(pe,"-contextmenu")).css("width","160px")).children.apply(e,Rs(qs.call(this))).hide(),this.itemClick=function(){}}),[{key:"hide",value:function(){var t=this.el;t.hide(),fe(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),se(e)}}])}(),Js=function(){return Bs((function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};Ns(this,t),this.swapFunc=n,this.updateFunc=i,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new Vs((function(t){e.clickSwap2(e.items[t])})),this.contextMenu=new Ls,this.contextMenu.itemClick=o,this.el=f("div","".concat(pe,"-bottombar")).children(this.contextMenu.el,this.menuEl=f("ul","".concat(pe,"-menu")).child(f("li","").children(new or("add").on("click",(function(){r()})),f("span","").child(this.moreEl))))}),[{key:"addItem",value:function(t,e,r){var n=this;this.dataNames.push(t);var o=f("li",e?"active":"").child(t);o.on("click",(function(){n.clickSwap2(o)})).on("contextmenu",(function(t){if("read"!==r.mode){var e=t.target,i=e.offsetLeft,a=e.offsetHeight;n.contextMenu.setOffset({left:i,bottom:a+1}),n.deleteEl=o}})).on("dblclick",(function(){if("read"!==r.mode){var t=o.html(),e=new mf("auto","");e.val(t),e.input.on("blur",(function(e){var r=e.target.value,o=n.dataNames.findIndex((function(e){return e===t}));n.renameItem(o,r)})),o.html("").child(e.el),e.focus()}})),e&&this.clickSwap(o),this.items.push(o),this.menuEl.child(o),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var r=this.items.findIndex((function(t){return t===e}));if(this.items.splice(r,1),this.dataNames.splice(r,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var n=As(this.items,1)[0];return this.activeEl=n,this.activeEl.toggle(),[r,0]}return[r,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}])}();r(1);function Xs(t){return(Xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ys(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Zs(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zs(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zs(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ks(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Gs(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ks(Object(r),!0).forEach((function(e){Qs(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ks(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Qs(t,e,r){return(e=rh(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function th(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rh(n.key),n)}}function rh(t){var e=function(t,e){if("object"!=Xs(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Xs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xs(e)?e:e+""}var nh=function(){return t=function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};th(this,t);var o=e;this.options=Gs({showBottomBar:!0},n),this.sheetIndex=1,this.datas=[],"string"==typeof e&&(o=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new Js((function(){if("read"!==r.options.mode){var t=r.addSheet();r.sheet.resetData(t)}}),(function(t){var e=r.datas[t];r.sheet.resetData(e)}),(function(){r.deleteSheet()}),(function(t,e){r.datas[t].name=e,r.sheet.trigger("change")})):null,this.data=this.addSheet();var i=f("div","".concat(pe)).on("contextmenu",(function(t){return t.preventDefault()}));o.appendChild(i.el),this.sheet=new Cs(i,this.data),null!==this.bottombar&&i.child(this.bottombar.el)},r=[{key:"locale",value:function(t,e){Pt(t,e)}}],(e=[{key:"addSheet",value:function(t){var e=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t||"sheet".concat(this.sheetIndex),o=new oe(n,this.options,this.sheet);return o.change=function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];(t=e.sheet).trigger.apply(t,["change"].concat(n))},this.datas.push(o),null!==this.bottombar&&this.bottombar.addItem(n,r,this.options),this.sheetIndex+=1,o}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=Ys(this.bottombar.deleteItem(),2),e=t[0],r=t[1];e>=0&&(this.datas.splice(e,1),r>=0&&this.sheet.resetData(this.datas[r]),this.sheet.trigger("change"))}}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(var r=0;r<e.length;r+=1){var n=e[r],o=this.addSheet(n.name,0===r);o.setData(n),0===r&&this.sheet.resetData(o)}return this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[n].setCellText(t,e,r,"finished"),this}},{key:"cell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}},{key:"jumpToRow",value:function(t){this.sheet.jump(t)}}])&&eh(t.prototype,e),r&&eh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),oh=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new nh(t,e)};window&&(window.x_spreadsheet=oh,window.x_spreadsheet.locale=function(t,e){return Pt(t,e)});e.default=nh}]);
//# sourceMappingURL=xspreadsheet.js.map